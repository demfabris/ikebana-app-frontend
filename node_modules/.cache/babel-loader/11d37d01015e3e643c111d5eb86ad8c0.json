{"ast":null,"code":"import _regeneratorRuntime from\"/home/fabricio7p/Documents/Projects/Ikebana/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/fabricio7p/Documents/Projects/Ikebana/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"/home/fabricio7p/Documents/Projects/Ikebana/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/fabricio7p/Documents/Projects/Ikebana/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{useDispatch,useSelector}from'react-redux';import{useHistory}from'react-router-dom';import{addCart}from'store/ducks/shop';import Slider from'react-slick';import api from'services/api';import Dialog from'../../Dialog';import Modal from'../../../aux/Modal';import ErrorDialog from'../../../aux/ErrorDialog/ErrorDialog';import'./styles.scss';export default function ArrangementDialog(_ref){var handler=_ref.handler,el=_ref.el,likeHandler=_ref.likeHandler,likeCount=_ref.likeCount;var authKey=useSelector(function(state){return state.auth.keys;});var _useState=useState(true),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),userID=_useState4[0],setUserID=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),liked=_useState6[0],setLiked=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),ordered=_useState8[0],setOrdered=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),owner=_useState10[0],setOwner=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),error=_useState12[0],setError=_useState12[1];var history=useHistory();//carousel custom settings\nfunction SampleNextArrow(props){var className=props.className,style=props.style,onClick=props.onClick;return/*#__PURE__*/React.createElement(\"div\",{className:\"custom-arrow dialog-next\",style:_objectSpread({},style,{display:\"block\"}),onClick:onClick},/*#__PURE__*/React.createElement(\"i\",{class:\"material-icons\"},\"arrow_forward_ios\"));}function SamplePrevArrow(props){var className=props.className,style=props.style,onClick=props.onClick;return/*#__PURE__*/React.createElement(\"div\",{className:\"custom-arrow dialog-prev\",style:_objectSpread({},style,{display:\"block\"}),onClick:onClick},/*#__PURE__*/React.createElement(\"i\",{class:\"material-icons\"},\"arrow_back_ios\"));}var settings={arrows:true,dots:false,infinite:true,speed:500,slidesToShow:1,slidesToScroll:1,nextArrow:/*#__PURE__*/React.createElement(SampleNextArrow,null),prevArrow:/*#__PURE__*/React.createElement(SamplePrevArrow,null)};//end carousel settings\n//dispatching to cart\nvar cart=useSelector(function(state){return state.shop.cart;});var dispatch=useDispatch();var addToCart=function addToCart(){if(owner){setError('Você não pode solicitar o arranjo a sí mesmo(a)');}else{dispatch(addCart({'project_id':el.project_id,'name':el.name,'picture':el.pictures.file1}));setOrdered(true);}};//fetching user_id to check like status\nvar fetchUsername=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var key,username,_args=arguments;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:key=_args.length>0&&_args[0]!==undefined?_args[0]:authKey;_context.prev=1;_context.next=4;return api({method:'get',url:'/user',headers:{'Authorization':\"Bearer \".concat(key[0].key)}});case 4:username=_context.sent;console.log(el);setUserID(username.data.id);el.autor===username.data.email?setOwner(true):console.log('');_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](1);console.log(_context.t0);case 13:_context.prev=13;setLoading(false);return _context.finish(13);case 16:case\"end\":return _context.stop();}}},_callee,null,[[1,10,13,16]]);}));return function fetchUsername(){return _ref2.apply(this,arguments);};}();//commiting like to db\nvar commitLike=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var key,response,_args2=arguments;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:key=_args2.length>0&&_args2[0]!==undefined?_args2[0]:authKey;_context2.prev=1;_context2.next=4;return api({method:'post',url:'/like_project',headers:{'Authorization':\"Bearer \".concat(key[0].key)},data:{project_id:el.project_id}});case 4:response=_context2.sent;console.log(response.data);_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](1);console.log(_context2.t0);case 11:case\"end\":return _context2.stop();}}},_callee2,null,[[1,8]]);}));return function commitLike(){return _ref3.apply(this,arguments);};}();useEffect(function(){fetchUsername();cart.map(function(obj){return Object.values(obj).includes(el.project_id)&&setOrdered('Adicionado');});},[]);return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Dialog,{handler:handler},/*#__PURE__*/React.createElement(\"div\",{className:\"arrangement-landscape\"},/*#__PURE__*/React.createElement(\"div\",{className:\"arrangement-landscape__picture\"},/*#__PURE__*/React.createElement(Slider,settings,el.pictures.file1&&/*#__PURE__*/React.createElement(\"div\",{className:\"arrangement-landscape__picture--slide\"},/*#__PURE__*/React.createElement(\"img\",{className:\"slide-img\",src:el.pictures.file1})),el.pictures.file2&&/*#__PURE__*/React.createElement(\"div\",{className:\"arrangement-landscape__picture--slide\"},/*#__PURE__*/React.createElement(\"img\",{className:\"slide-img\",src:el.pictures.file2})),el.pictures.file3&&/*#__PURE__*/React.createElement(\"div\",{className:\"arrangement-landscape__picture--slide\"},/*#__PURE__*/React.createElement(\"img\",{className:\"slide-img\",src:el.pictures.file3})))),/*#__PURE__*/React.createElement(\"div\",{className:\"arrangement-landscape__about\"},/*#__PURE__*/React.createElement(\"div\",{className:\"arrangement-landscape__about--header\"},/*#__PURE__*/React.createElement(\"h1\",{className:\"arrangement-title\"},el.name),authKey.length!==0&&/*#__PURE__*/React.createElement(\"button\",{onClick:el.allow&&!ordered?addToCart:'',title:el.allow?'Fazer uma solicitação deste arranjo':'O autor não permite solicitações deste arranjo',className:el.allow&&!ordered?'app-btn':'btn-inactive'},!ordered?'Solicitar':'Adicionado')),/*#__PURE__*/React.createElement(\"div\",{className:\"arrangement-landscape__about--desc\"},/*#__PURE__*/React.createElement(\"div\",{className:\"arrangement-autor\"},/*#__PURE__*/React.createElement(\"img\",{className:\"arrangement-autor__img\",src:el.autor_pic}),/*#__PURE__*/React.createElement(\"p\",{className:\"arrangement-autor__name\"},el.autor_fullname.toLowerCase(),\" \",/*#__PURE__*/React.createElement(\"b\",null,\"-\"))),/*#__PURE__*/React.createElement(\"p\",{className:\"arrangement-landscape__about--desc--text\"},el.description)),/*#__PURE__*/React.createElement(\"div\",{className:\"arrangement-landscape__about--footer\"},/*#__PURE__*/React.createElement(\"div\",{className:\"arrangement-likes\"},/*#__PURE__*/React.createElement(\"p\",{className:\"arrangement-likes__num\"},likeCount),/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){if(!Object.keys(el.liked_by).includes(userID.toString())){setLiked(true);commitLike();likeHandler();}},className:\"arrangement-likes__like\"},Object.keys(el.liked_by).includes(userID.toString())?/*#__PURE__*/React.createElement(\"i\",{title:\"Curtido\",className:\"material-icons\"},\"favorite\"):/*#__PURE__*/React.createElement(\"i\",{className:\"material-icons\"},liked?'favorite':'favorite_border'))),el.video===''?/*#__PURE__*/React.createElement(\"button\",{title:\"Este projeto n\\xE3o possui video\",className:\"btn-inactive arr-btn\"},\"Video\"):/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return history.push(\"/lesson/\".concat(el.project_id.toString()));},className:\"app-btn arr-btn\"},\"Video\")))),/*#__PURE__*/React.createElement(\"div\",{className:\"arrangement-portrait\"},/*#__PURE__*/React.createElement(\"div\",{className:\"arrangement-portrait__header\"},/*#__PURE__*/React.createElement(\"h1\",{className:\"arrangement-title\"},el.name),authKey.length!==0&&/*#__PURE__*/React.createElement(\"button\",{onClick:el.allow&&!ordered?addToCart:'',title:el.allow?'Fazer uma solicitação deste arranjo':'O autor não permite solicitações deste arranjo',className:el.allow&&!ordered?'app-btn':'btn-inactive'},!ordered?'Solicitar':'Adicionado')),/*#__PURE__*/React.createElement(\"div\",{className:\"arrangement-portrait__picture\"},/*#__PURE__*/React.createElement(Slider,settings,el.pictures.file1&&/*#__PURE__*/React.createElement(\"div\",{className:\"arrangement-portrait__picture--slide\"},/*#__PURE__*/React.createElement(\"img\",{className:\"slide-img\",src:el.pictures.file1})),el.pictures.file2&&/*#__PURE__*/React.createElement(\"div\",{className:\"arrangement-portrait__picture--slide\"},/*#__PURE__*/React.createElement(\"img\",{className:\"slide-img\",src:el.pictures.file2})),el.pictures.file3&&/*#__PURE__*/React.createElement(\"div\",{className:\"arrangement-portrait__picture--slide\"},/*#__PURE__*/React.createElement(\"img\",{className:\"slide-img\",src:el.pictures.file3})))),/*#__PURE__*/React.createElement(\"div\",{className:\"arrangement-portrait__desc\"},/*#__PURE__*/React.createElement(\"div\",{className:\"arrangement-autor\"},/*#__PURE__*/React.createElement(\"img\",{className:\"arrangement-autor__img\",src:el.autor_pic,alt:\"Autor img\"}),/*#__PURE__*/React.createElement(\"p\",{className:\"arrangement-autor__name\"},el.autor_fullname.toLowerCase(),\" \",/*#__PURE__*/React.createElement(\"b\",null,\"-\"))),/*#__PURE__*/React.createElement(\"p\",{className:\"arrangement-portrait__desc--text\"},el.description)),/*#__PURE__*/React.createElement(\"div\",{className:\"arrangement-portrait__footer\"},/*#__PURE__*/React.createElement(\"div\",{className:\"arrangement-portrait__footer--likes\"},/*#__PURE__*/React.createElement(\"p\",{className:\"arrangement-likes__num\"},likeCount),/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){if(!Object.keys(el.liked_by).includes(userID.toString())){setLiked(true);commitLike();likeHandler();}},className:\"arrangement-likes__like\"},Object.keys(el.liked_by).includes(userID.toString())?/*#__PURE__*/React.createElement(\"i\",{title:\"Curtido\",className:\"material-icons\"},\"favorite\"):/*#__PURE__*/React.createElement(\"i\",{className:\"material-icons\"},liked?'favorite':'favorite_border'))),el.video===''?/*#__PURE__*/React.createElement(\"button\",{title:\"Este projeto n\\xE3o possui video\",className:\"btn-inactive arr-btn lesson-btn\"},\"Video\"):/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return history.push(\"/lesson/\".concat(el.project_id.toString()));},className:\"app-btn arr-btn lesson-btn\"},\"Video\")))),error&&/*#__PURE__*/React.createElement(Modal,null,/*#__PURE__*/React.createElement(ErrorDialog,{handler:function handler(){return setError(false);},value:error})));}","map":{"version":3,"sources":["/home/fabricio7p/Documents/Projects/Ikebana/front/src/components/Dialog/components/ArrangementDialog/ArrangementDialog.js"],"names":["React","useState","useEffect","useDispatch","useSelector","useHistory","addCart","Slider","api","Dialog","Modal","ErrorDialog","ArrangementDialog","handler","el","likeHandler","likeCount","authKey","state","auth","keys","loading","setLoading","userID","setUserID","liked","setLiked","ordered","setOrdered","owner","setOwner","error","setError","history","SampleNextArrow","props","className","style","onClick","display","SamplePrevArrow","settings","arrows","dots","infinite","speed","slidesToShow","slidesToScroll","nextArrow","prevArrow","cart","shop","dispatch","addToCart","project_id","name","pictures","file1","fetchUsername","key","method","url","headers","username","console","log","data","id","autor","email","commitLike","response","map","obj","Object","values","includes","file2","file3","length","allow","autor_pic","autor_fullname","toLowerCase","description","liked_by","toString","video","push"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useHistory } from 'react-router-dom';\nimport { addCart } from 'store/ducks/shop';\nimport Slider from 'react-slick';\nimport api from 'services/api';\n\nimport Dialog from '../../Dialog';\nimport Modal from '../../../aux/Modal';\nimport ErrorDialog from '../../../aux/ErrorDialog/ErrorDialog';\n\nimport './styles.scss';\n\nexport default function ArrangementDialog({ handler, el, likeHandler, likeCount }) {\n    const authKey = useSelector(state => state.auth.keys)\n    const [loading, setLoading] = useState(true);\n    const [userID, setUserID] = useState(false);\n    const [liked, setLiked] = useState(false);\n    const [ordered, setOrdered] = useState(false);\n    const [owner, setOwner] = useState(false);\n    const [error, setError] = useState(false);\n    const history = useHistory();\n\n\n    //carousel custom settings\n    function SampleNextArrow(props) {\n        const { className, style, onClick } = props;\n        return (\n            <div\n                className={\"custom-arrow dialog-next\"}\n                style={{ ...style, display: \"block\" }}\n                onClick={onClick}\n            >\n                <i class=\"material-icons\">arrow_forward_ios</i>\n            </div>\n        );\n    }\n    function SamplePrevArrow(props) {\n        const { className, style, onClick } = props;\n        return (\n            <div\n                className={\"custom-arrow dialog-prev\"}\n                style={{ ...style, display: \"block\" }}\n                onClick={onClick}\n            >\n                <i class=\"material-icons\">arrow_back_ios</i>\n            </div>\n        );\n    }\n    const settings = {\n        arrows: true,\n        dots: false,\n        infinite: true,\n        speed: 500,\n        slidesToShow: 1,\n        slidesToScroll: 1,\n        nextArrow: <SampleNextArrow />,\n        prevArrow: <SamplePrevArrow />\n    };\n    //end carousel settings\n\n    //dispatching to cart\n    const cart = useSelector(state => state.shop.cart)\n    const dispatch = useDispatch();\n    const addToCart = () => {\n        if (owner) {\n            setError('Você não pode solicitar o arranjo a sí mesmo(a)')   \n        } else {\n            dispatch(addCart({\n                'project_id': el.project_id,\n                'name': el.name,\n                'picture': el.pictures.file1,\n            }))\n            setOrdered(true)\n        }\n    }\n\n\n    //fetching user_id to check like status\n    const fetchUsername = async (key=authKey) => {\n        try {\n            const username = await api({\n                method: 'get',\n                url: '/user',\n                headers: {\n                    'Authorization': `Bearer ${key[0].key}`\n                },\n            })\n            console.log(el)\n            setUserID(username.data.id)\n            el.autor === username.data.email ? setOwner(true) : console.log('')\n        } catch(e) {\n            console.log(e)\n        } finally {\n            setLoading(false)\n        }\n    }\n\n    //commiting like to db\n    const commitLike = async (key=authKey) => {\n        try {\n            const response = await api({\n                method: 'post',\n                url: '/like_project',\n                headers: {\n                    'Authorization': `Bearer ${key[0].key}`\n                },\n                data: {\n                    project_id: el.project_id\n                }\n            })\n            console.log(response.data)\n        } catch(e) {\n            console.log(e)\n        } \n    }\n\n    useEffect(() => {\n        fetchUsername()\n        cart.map((obj) => (\n            Object.values(obj).includes(el.project_id)) && setOrdered('Adicionado')\n        )\n    },[])\n\n\n    return(\n        <>\n        <Dialog handler={handler}>\n            <div className=\"arrangement-landscape\">\n                <div className=\"arrangement-landscape__picture\">\n                    <Slider {...settings}>\n                        {\n                            el.pictures.file1 && \n                                <div className=\"arrangement-landscape__picture--slide\">\n                                    <img className=\"slide-img\" src={el.pictures.file1} />\n                                </div>\n                        }\n                        {\n                            el.pictures.file2 && \n                                <div className=\"arrangement-landscape__picture--slide\">\n                                    <img className=\"slide-img\" src={el.pictures.file2} />\n                                </div>\n                        }\n                        {\n                            el.pictures.file3 && \n                                <div className=\"arrangement-landscape__picture--slide\">\n                                    <img className=\"slide-img\" src={el.pictures.file3} />\n                                </div>\n                        }\n                    </Slider>\n                </div>\n                <div className=\"arrangement-landscape__about\">\n                    <div className=\"arrangement-landscape__about--header\">\n                        <h1 className=\"arrangement-title\">{el.name}</h1>\n                        {\n                            authKey.length !== 0 &&\n                        <button onClick={(el.allow && !ordered) ? addToCart : ''} \n                            title={el.allow ? 'Fazer uma solicitação deste arranjo' \n                            : 'O autor não permite solicitações deste arranjo'}\n                            className={el.allow && !ordered ? 'app-btn' : 'btn-inactive'}>\n                        {!ordered ? 'Solicitar' : 'Adicionado'}</button>\n                        }\n                    </div>\n                    <div className=\"arrangement-landscape__about--desc\">\n                        <div className=\"arrangement-autor\">\n                            <img className=\"arrangement-autor__img\" src={el.autor_pic} />\n                            <p className=\"arrangement-autor__name\">{el.autor_fullname.toLowerCase()} <b>-</b></p>\n                        </div>\n                        <p className=\"arrangement-landscape__about--desc--text\">\n                            {el.description}\n                        </p>\n                    </div>\n                    <div className=\"arrangement-landscape__about--footer\">\n                        <div className=\"arrangement-likes\">\n                            <p className=\"arrangement-likes__num\">{likeCount}</p>\n                            <button onClick={() => {\n                                if (!Object.keys(el.liked_by).includes(userID.toString())) {\n                                    setLiked(true)\n                                    commitLike()\n                                    likeHandler()\n                                }}} \n                                className=\"arrangement-likes__like\">\n                                {\n                                    Object.keys(el.liked_by).includes(userID.toString()) ?\n                                        <i title=\"Curtido\" \n                                    className=\"material-icons\">favorite</i>\n                                            :\n                                        <i className=\"material-icons\">{liked ? 'favorite' \n                                        : 'favorite_border'}</i>\n                                }\n                            </button>\n                        </div>\n                        {\n                            el.video === '' ? \n                            <button title=\"Este projeto não possui video\" \n                            className=\"btn-inactive arr-btn\">Video</button>\n                                :\n                                <button onClick={() => \n                                        history.push(`/lesson/${el.project_id.toString()}`)} \n                            className=\"app-btn arr-btn\">Video</button>\n                        }\n                    </div>\n                </div>\n            </div>\n            <div className=\"arrangement-portrait\">\n                <div className=\"arrangement-portrait__header\">\n                    <h1 className=\"arrangement-title\">{el.name}</h1>\n                    {\n                        authKey.length !== 0 &&\n                        <button onClick={(el.allow && !ordered) ? addToCart : ''} \n                            title={el.allow ? 'Fazer uma solicitação deste arranjo' \n                            : 'O autor não permite solicitações deste arranjo'}\n                            className={el.allow && !ordered ? 'app-btn' : 'btn-inactive'}>\n                        {!ordered ? 'Solicitar' : 'Adicionado'}</button>\n                    }\n                </div>\n                <div className=\"arrangement-portrait__picture\">\n                    <Slider {...settings}>\n                        {\n                            el.pictures.file1 && \n                                <div className=\"arrangement-portrait__picture--slide\">\n                                    <img className=\"slide-img\" src={el.pictures.file1} />\n                                </div>\n                        }\n                        {\n                            el.pictures.file2 && \n                                <div className=\"arrangement-portrait__picture--slide\">\n                                    <img className=\"slide-img\" src={el.pictures.file2} />\n                                </div>\n                        }\n                        {\n                            el.pictures.file3 && \n                                <div className=\"arrangement-portrait__picture--slide\">\n                                    <img className=\"slide-img\" src={el.pictures.file3} />\n                                </div>\n                        }\n                    </Slider>\n                </div>\n                <div className=\"arrangement-portrait__desc\">\n                    <div className=\"arrangement-autor\">\n                        <img className=\"arrangement-autor__img\" \n                            src={el.autor_pic} alt=\"Autor img\" />\n                        <p className=\"arrangement-autor__name\">{el.autor_fullname.toLowerCase()} <b>-</b></p>\n                    </div>\n                    <p className=\"arrangement-portrait__desc--text\">{el.description}</p>\n                </div>\n                <div className=\"arrangement-portrait__footer\">\n                    <div className=\"arrangement-portrait__footer--likes\">\n                            <p className=\"arrangement-likes__num\">{likeCount}</p>\n                            <button onClick={() => {\n                                if (!Object.keys(el.liked_by).includes(userID.toString())) {\n                                    setLiked(true)\n                                    commitLike()\n                                    likeHandler()\n                                }}} \n                                className=\"arrangement-likes__like\">\n                                {\n                                    Object.keys(el.liked_by).includes(userID.toString()) ?\n                                        <i title=\"Curtido\" \n                                    className=\"material-icons\">favorite</i>\n                                            :\n                                        <i className=\"material-icons\">{liked ? 'favorite' \n                                        : 'favorite_border'}</i>\n                                }\n                            </button>\n                    </div>\n                        {\n                            el.video === '' ? \n                            <button title=\"Este projeto não possui video\" \n                            className=\"btn-inactive arr-btn lesson-btn\">Video</button>\n                                :\n                                <button onClick={() => \n                                        history.push(`/lesson/${el.project_id.toString()}`)} \n                            className=\"app-btn arr-btn lesson-btn\">Video</button>\n                        }\n                </div>\n            </div>\n        </Dialog>\n        {\n            error &&\n                <Modal>\n                    <ErrorDialog handler={() => setError(false)} value={error}/>\n                </Modal>\n        }\n        </>\n    );\n}\n"]},"metadata":{},"sourceType":"module"}