{"ast":null,"code":"import _regeneratorRuntime from\"/home/fabricio7p/Documents/Projects/Ikebana/Frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/fabricio7p/Documents/Projects/Ikebana/Frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/fabricio7p/Documents/Projects/Ikebana/Frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{useSelector,useDispatch}from'react-redux';import api from'services/api';import{storeUserData,clearUserData}from'store/ducks/account';import{refreshAuth}from'store/ducks/auth';import Join from'./components/Join/Join';import EditAccount from'./components/EditAccount/EditAccount';import Password from'./components/Password/Password';import NewProject from'./components/New/NewProject';import EditProject from'./components/Edit/EditProject';import'./styles.scss';function Blank(){return/*#__PURE__*/React.createElement(React.Fragment,null);}export default function Account(){var _useState=useState(true),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var dispatch=useDispatch();var authKey=useSelector(function(state){return state.auth.keys;});var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isOauth=_useState4[0],setIsOauth=_useState4[1];var hitApi=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(key){var response,refresh_key,onExpire,_key;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return api({method:'get',url:'/user',headers:{'Authorization':\"Bearer \".concat(key[0].key)}});case 3:response=_context.sent;dispatch(storeUserData(response.data));response.data.is_oauth&&setIsOauth(true);_context.next=17;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);refresh_key=authKey[0].refresh_key;_context.next=13;return api({method:'get',url:'/refresh',headers:{'Authorization':\"Bearer \".concat(refresh_key)}});case 13:onExpire=_context.sent;_key=onExpire.data.key;dispatch(refreshAuth({key:_key,refresh_key:refresh_key}));window.location.reload();case 17:_context.prev=17;setLoading(false);return _context.finish(17);case 20:case\"end\":return _context.stop();}}},_callee,null,[[0,8,17,20]]);}));return function hitApi(_x){return _ref.apply(this,arguments);};}();//TAB handling\nvar _useState5=useState('blank'),_useState6=_slicedToArray(_useState5,2),active=_useState6[0],setActive=_useState6[1];var tabsComponent={'blank':Blank,'join':Join,'password':Password,'edit':EditAccount,'new_project':NewProject,'edit_project':EditProject};var ActiveComponent=tabsComponent[active];useEffect(function(){window.scrollTo(0,0);var path=window.location.pathname.slice(9);path&&setActive(path);},[]);var handleClick=function handleClick(action){return function(){window.location.pathname='/account/'+action;setActive(action);};};//auth handling\nuseEffect(function(){if(authKey.length===0){window.location.pathname='/login';alert('Você precisa entrar para acessar essa página');}else{hitApi(authKey);}return function(){dispatch(clearUserData());};},[]);return/*#__PURE__*/React.createElement(\"div\",{className:\"account\"},/*#__PURE__*/React.createElement(\"div\",{className:\"account-main\"},/*#__PURE__*/React.createElement(\"div\",{className:\"account-main__sidebar\"},/*#__PURE__*/React.createElement(\"ul\",{className:\"account-main__sidebar--list\"},/*#__PURE__*/React.createElement(\"li\",{onClick:handleClick('join'),className:\"tab-element \\n                            \".concat(active==='join'?'el-active':'')},/*#__PURE__*/React.createElement(\"button\",{className:\"tab-element__btn \\n                                \".concat(active==='join'?'txt-active':'')},\"Participar\")),/*#__PURE__*/React.createElement(\"li\",{onClick:handleClick('edit'),className:\"tab-element \\n                            \".concat(active==='edit'?'el-active':'')},/*#__PURE__*/React.createElement(\"button\",{className:\"tab-element__btn \\n                                \".concat(active==='edit'?'txt-active':'')},\"Editar Informa\\xE7\\xF5es\")),!loading&&!isOauth&&/*#__PURE__*/React.createElement(\"li\",{onClick:handleClick('password'),className:\"tab-element \\n                                    \".concat(active==='password'?'el-active':'')},/*#__PURE__*/React.createElement(\"button\",{className:\"tab-element__btn \\n                                        \".concat(active==='password'?'txt-active':'')},\"Senha\")),/*#__PURE__*/React.createElement(\"li\",{onClick:handleClick('new_project'),className:\"tab-element \\n                            \".concat(active==='new_project'?'el-active':'')},/*#__PURE__*/React.createElement(\"button\",{className:\"tab-element__btn \\n                                \".concat(active==='new_project'?'txt-active':'')},\"Novo Projeto\")),/*#__PURE__*/React.createElement(\"li\",{style:{cursor:\"auto\"},className:\"tab-element \\n                            \".concat(active==='edit_project'?'el-active':'')},/*#__PURE__*/React.createElement(\"button\",{style:{color:\"#969696\",cursor:\"auto\"},className:\"tab-element__btn \\n                                \".concat(active==='edit_project'?'txt-active':'')},\"Editar Projeto\")))),/*#__PURE__*/React.createElement(\"div\",{className:\"account-main__container\"},!loading&&/*#__PURE__*/React.createElement(ActiveComponent,null))));}","map":{"version":3,"sources":["/home/fabricio7p/Documents/Projects/Ikebana/Frontend/src/components/pages/Account/Account.js"],"names":["React","useEffect","useState","useSelector","useDispatch","api","storeUserData","clearUserData","refreshAuth","Join","EditAccount","Password","NewProject","EditProject","Blank","Account","loading","setLoading","dispatch","authKey","state","auth","keys","isOauth","setIsOauth","hitApi","key","method","url","headers","response","data","is_oauth","refresh_key","onExpire","window","location","reload","active","setActive","tabsComponent","ActiveComponent","scrollTo","path","pathname","slice","handleClick","action","length","alert","cursor","color"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport api from 'services/api';\n\nimport { storeUserData, clearUserData } from 'store/ducks/account';\nimport { refreshAuth } from 'store/ducks/auth';\n\nimport Join from './components/Join/Join';\nimport EditAccount from './components/EditAccount/EditAccount';\nimport Password from './components/Password/Password';\nimport NewProject from './components/New/NewProject';\nimport EditProject from './components/Edit/EditProject';\n\nimport './styles.scss';\n\nfunction Blank() {\n    return(\n        <>\n        </>\n    );\n}\n\nexport default function Account() {\n    const [loading, setLoading] = useState(true);\n    const dispatch = useDispatch();\n    const authKey = useSelector(state => state.auth.keys);\n    const [isOauth, setIsOauth] = useState(false);\n\n\n    const hitApi = async (key) => {\n        try{\n            const response = await api({\n                method: 'get',\n                url: '/user',\n                headers: {\n                    'Authorization': `Bearer ${key[0].key}`\n                },\n            })\n            dispatch(storeUserData(response.data))\n            response.data.is_oauth && setIsOauth(true)\n        } catch(e){\n            const refresh_key = authKey[0].refresh_key\n            const onExpire = await api({\n                method: 'get',\n                url: '/refresh',\n                headers: {\n                    'Authorization': `Bearer ${refresh_key}`\n                }\n            })\n            const { key } = onExpire.data\n            dispatch(refreshAuth({ key, refresh_key }))\n            window.location.reload()\n        } finally {\n            setLoading(false)\n        }\n    }\n\n    //TAB handling\n    const [active, setActive] = useState('blank');\n    const tabsComponent = {\n        'blank': Blank,\n        'join': Join,\n        'password': Password,\n        'edit': EditAccount,\n        'new_project': NewProject,\n        'edit_project': EditProject\n    };\n    const ActiveComponent = tabsComponent[active];\n    \n    useEffect(() => {\n        window.scrollTo(0, 0)\n        const path = window.location.pathname.slice(9)\n        path && setActive(path);\n    }, []);\n\n    const handleClick = (action) => () => {\n        window.location.pathname = '/account/' + action;\n        setActive(action)\n    }\n\n    //auth handling\n    useEffect(() => {\n        if (authKey.length === 0) {\n            window.location.pathname = '/login'\n            alert('Você precisa entrar para acessar essa página')\n        } else {\n            hitApi(authKey)\n        }\n\n        return () => {\n            dispatch(clearUserData())\n        }\n    }, [])\n\n    return(\n        <div className=\"account\">\n            <div className=\"account-main\">\n                <div className=\"account-main__sidebar\">\n                    <ul className=\"account-main__sidebar--list\">\n                        <li onClick={handleClick('join')} \n                        className={`tab-element \n                            ${active === 'join' ? 'el-active' : ''}`}>\n                            <button className={`tab-element__btn \n                                ${active === 'join' ? 'txt-active' : ''}`}>\n                            Participar</button>\n                        </li>\n                        <li onClick={handleClick('edit')} \n                        className={`tab-element \n                            ${active === 'edit' ? 'el-active' : ''}`}>\n                            <button className={`tab-element__btn \n                                ${active === 'edit' ? 'txt-active' : ''}`}>\n                            Editar Informações</button>\n                        </li>\n                        {\n                            !loading && !isOauth &&\n                                <li onClick={handleClick('password')} \n                                className={`tab-element \n                                    ${active === 'password' ? 'el-active' : ''}`}>\n                                    <button className={`tab-element__btn \n                                        ${active === 'password' ? 'txt-active' : ''}`}>\n                                    Senha</button>\n                                </li>\n                        }\n                        <li onClick={handleClick('new_project')} \n                        className={`tab-element \n                            ${active === 'new_project' ? 'el-active' : ''}`}>\n                            <button className={`tab-element__btn \n                                ${active === 'new_project' ? 'txt-active' : ''}`}>\n                            Novo Projeto</button>\n                        </li>\n                        <li style={{cursor: \"auto\"}} className={`tab-element \n                            ${active === 'edit_project' ? 'el-active' : ''}`}>\n                            <button style={{color: \"#969696\", cursor: \"auto\"}} \n                            className={`tab-element__btn \n                                ${active === 'edit_project' ? 'txt-active' : ''}`}>\n                            Editar Projeto</button>\n                        </li>\n                    </ul>\n                </div>\n                <div className=\"account-main__container\">\n                    {\n                        !loading &&\n                            <ActiveComponent />\n                    }\n                </div>\n            </div>\n        </div>\n    );\n}\n"]},"metadata":{},"sourceType":"module"}