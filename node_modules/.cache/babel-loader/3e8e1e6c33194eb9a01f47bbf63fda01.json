{"ast":null,"code":"import _regeneratorRuntime from\"/home/fabricio7p/Documents/Projects/Ikebana/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/fabricio7p/Documents/Projects/Ikebana/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/fabricio7p/Documents/Projects/Ikebana/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{Link,useHistory,useLocation}from'react-router-dom';import{useSelector,useDispatch}from'react-redux';import{changeUrl}from'store/ducks/links';import{loadNotif}from'store/ducks/notifications';import{refreshAuth}from'store/ducks/auth';import SettingsDialog from'../aux/SettingsDialog/SettingsDialog';import Modal from'../aux/Modal';import api from'../../services/api';import'./styles.scss';import Clipper from'../aux/Clipper/Clipper';//Page names\nvar Pages={'explore':'Explorar','account':'Conta','home':'Perfil','lessons':'Aulas','lesson':'Aula'};var CurrentUrl=function CurrentUrl(){var active=useLocation();return active.pathname.slice(1).split('/')[0];};export default function Header(){var dispatch=useDispatch();var history=useHistory();//shrink on scroll\nuseEffect(function(){window.onscroll=function(){shrinkOnScroll();};var shrinkOnScroll=function shrinkOnScroll(){if(document.body.scrollTop>80||document.documentElement.scrollTop>80){if(window.location.pathname!=='/motivation'&&window.location.pathname!=='/register'&&window.location.pathname!=='/login'&&window.location.pathname!=='/forgot_pass'&&window.location.pathname!=='/logout'){document.getElementById(\"header_main\").style.height=\"3.5em\";document.getElementById(\"menu_container\").style.top=\"4px\";document.getElementById(\"sidebar_menu\").style.transform=\"translateY(-1.5em)\";}}else{if(window.location.pathname!=='/motivation'&&window.location.pathname!=='/register'&&window.location.pathname!=='/login'&&window.location.pathname!=='/forgot_pass'&&window.location.pathname!=='/logout'){document.getElementById(\"menu_container\").style.top=\"16px\";document.getElementById(\"header_main\").style.height=\"5em\";document.getElementById(\"sidebar_menu\").style.transform=\"translateY(0)\";}}};},[]);//hamburguer\nvar _useState=useState(true),_useState2=_slicedToArray(_useState,2),side=_useState2[0],setSide=_useState2[1];useEffect(function(){window.innerWidth<850&&setSide(false);},[]);var toggleSidebar=function toggleSidebar(){if(window.innerWidth<850){if(side){document.getElementById(\"main_sidebar\").style.transform=\"translateX(-220px)\";document.getElementById(\"side-overlay\").style.display=\"none\";setSide(false);}else{document.getElementById(\"main_sidebar\").style.transform=\"translateX(0px)\";document.getElementById(\"side-overlay\").style.display=\"block\";setSide(true);}}else{if(side){document.getElementById(\"main_sidebar\").style.transform=\"translateX(-220px)\";if(window.location.pathname.includes('explore')){document.getElementsByClassName(\"prev\")[0].style.transform=\"translateX(10px)\";}setSide(false);}else{document.getElementById(\"main_sidebar\").style.transform=\"translateX(0px)\";if(window.location.pathname.includes('explore')){document.getElementsByClassName(\"prev\")[0].style.transform=\"translateX(230px)\";}setSide(true);}}};//Buttons dialog\nvar _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),dialog=_useState4[0],setDialog=_useState4[1];//Buttons counter indicator\nvar cartCount=useSelector(function(state){return state.shop.cart.length;});var allNotif=useSelector(function(state){return state.notifications.notifications;});//Profile button\nvar _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),settings=_useState6[0],setSettings=_useState6[1];//Notif Counter\nvar _useState7=useState(allNotif.length),_useState8=_slicedToArray(_useState7,2),notifCount=_useState8[0],setnotifCount=_useState8[1];//Defaults\nvar defaults=useSelector(function(state){return state.defaults.data;});//Data fetching\nvar _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),data=_useState10[0],setData=_useState10[1];var authKey=useSelector(function(state){return state.auth.keys;});var hitApi=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(key){var response,refresh_key,onExpire,_key;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return api({method:'get',url:'/user',headers:{'Authorization':\"Bearer \".concat(key[0].key)}});case 3:response=_context.sent;dispatch(loadNotif(response.data.notifications));setData(response.data);_context.next=17;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);refresh_key=authKey[0].refresh_key;_context.next=13;return api({method:'post',url:'/refresh',headers:{'Authorization':\"Bearer \".concat(refresh_key)}});case 13:onExpire=_context.sent;_key=onExpire.data.key;dispatch(refreshAuth({key:_key,refresh_key:refresh_key}));window.location.reload();case 17:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}));return function hitApi(_x){return _ref.apply(this,arguments);};}();useEffect(function(){var interval=setInterval(function(){authKey.length!==0&&hitApi(authKey);},100000);return function(){return clearInterval(interval);};},[]);useEffect(function(){authKey.length!==0&&hitApi(authKey);},[]);useEffect(function(){setnotifCount(allNotif.filter(function(value){return value.is_read===false;}).length);});return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{onClick:toggleSidebar,id:\"side-overlay\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"header-main\",id:\"header_main\"},/*#__PURE__*/React.createElement(\"div\",{className:\"menu-container\",id:\"menu_container\"},/*#__PURE__*/React.createElement(\"button\",{onClick:toggleSidebar,id:\"hamburguer\"},/*#__PURE__*/React.createElement(\"i\",{className:\"material-icons\"},\"menu\")),/*#__PURE__*/React.createElement(\"div\",{className:\"sanguetsu-mark\"},/*#__PURE__*/React.createElement(\"img\",{className:\"header-logo\",src:\"https://ikebana-app-content.s3-sa-east-1.amazonaws.com/static/mainlogo_transparent_notext.png\",alt:\"logo\"}),/*#__PURE__*/React.createElement(\"p\",{className:\"logo-title\"},\"SANGUETSU\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"header-main__content\",id:\"header_title\"},/*#__PURE__*/React.createElement(\"div\",{className:\"header-main__content--title\"},/*#__PURE__*/React.createElement(\"div\",{className:\"title-limiter\"},/*#__PURE__*/React.createElement(\"h1\",{className:\"page-title\",id:\"header_title\"},Pages[CurrentUrl()]))),/*#__PURE__*/React.createElement(\"div\",{className:\"header-main__content--search\",id:\"search_box\"},/*#__PURE__*/React.createElement(\"i\",{className:\"material-icons\",id:\"search_icon\"},\"search\"),/*#__PURE__*/React.createElement(\"input\",{className:\"search-box\",id:\"search_inside\",type:\"text\",placeholder:\"Pesquisar\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"right-wrapper\"},/*#__PURE__*/React.createElement(\"div\",{className:\"shrink\"},/*#__PURE__*/React.createElement(\"div\",{className:\"header-main__content--buttons\"},/*#__PURE__*/React.createElement(\"div\",{className:\"button-wrapper\"},/*#__PURE__*/React.createElement(\"div\",{className:\"counter \".concat(cartCount===0?'counter-hidden':'')},/*#__PURE__*/React.createElement(\"p\",null,cartCount)),/*#__PURE__*/React.createElement(\"i\",{onClick:function onClick(){return setDialog(true);},className:\"material-icons\"},\"redeem\"),dialog&&/*#__PURE__*/React.createElement(Clipper,{handler:function handler(){return setDialog(false);}})),/*#__PURE__*/React.createElement(\"div\",{className:\"button-wrapper \".concat(authKey.length===0?'disabled':'')},/*#__PURE__*/React.createElement(\"div\",{className:\"counter \".concat(authKey.length===0?'counter-disabled':'',\" \").concat(notifCount===0?'counter-hidden':'')},/*#__PURE__*/React.createElement(\"p\",{className:\"notif-counter\"},notifCount)),/*#__PURE__*/React.createElement(Link,{onClick:function onClick(){authKey.length!==0&&dispatch(changeUrl('messages'));},to:\"/home\"},/*#__PURE__*/React.createElement(\"i\",{className:\"material-icons\"},\"notifications_none\")))),/*#__PURE__*/React.createElement(\"div\",{className:\"header-main__content--profile\"},/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){authKey.length!==0&&setSettings(true);},className:\"profile__btn\"},/*#__PURE__*/React.createElement(\"img\",{title:data.username,className:\"profile__btn--img\",src:\"\".concat(data.length===0?defaults.picture:data.picture),alt:\"Profile pic\"}))))))),settings&&/*#__PURE__*/React.createElement(Modal,null,/*#__PURE__*/React.createElement(SettingsDialog,{data:{'Perfil':'/home/arrangements','Configurações':'/account/edit','Sair':'/logout'},handler:function handler(){return setSettings(false);}})));}","map":{"version":3,"sources":["/home/fabricio7p/Documents/Projects/Ikebana/front/src/components/Header/Header.js"],"names":["React","useState","useEffect","Link","useHistory","useLocation","useSelector","useDispatch","changeUrl","loadNotif","refreshAuth","SettingsDialog","Modal","api","Clipper","Pages","CurrentUrl","active","pathname","slice","split","Header","dispatch","history","window","onscroll","shrinkOnScroll","document","body","scrollTop","documentElement","location","getElementById","style","height","top","transform","side","setSide","innerWidth","toggleSidebar","display","includes","getElementsByClassName","dialog","setDialog","cartCount","state","shop","cart","length","allNotif","notifications","settings","setSettings","notifCount","setnotifCount","defaults","data","setData","authKey","auth","keys","hitApi","key","method","url","headers","response","refresh_key","onExpire","reload","interval","setInterval","clearInterval","filter","value","is_read","username","picture"],"mappings":"qfAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,OAASC,IAAT,CAAeC,UAAf,CAA2BC,WAA3B,KAA8C,kBAA9C,CACA,OAASC,WAAT,CAAsBC,WAAtB,KAAyC,aAAzC,CACA,OAASC,SAAT,KAA0B,mBAA1B,CACA,OAASC,SAAT,KAA0B,2BAA1B,CACA,OAASC,WAAT,KAA4B,kBAA5B,CAEA,MAAOC,CAAAA,cAAP,KAA2B,sCAA3B,CACA,MAAOC,CAAAA,KAAP,KAAkB,cAAlB,CACA,MAAOC,CAAAA,GAAP,KAAgB,oBAAhB,CAEA,MAAO,eAAP,CAEA,MAAOC,CAAAA,OAAP,KAAoB,wBAApB,CAEA;AACA,GAAMC,CAAAA,KAAK,CAAG,CACV,UAAY,UADF,CAEV,UAAY,OAFF,CAGV,OAAS,QAHC,CAIV,UAAY,OAJF,CAKV,SAAW,MALD,CAAd,CAOA,GAAMC,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,EAAM,CACrB,GAAIC,CAAAA,MAAM,CAAGZ,WAAW,EAAxB,CACA,MAAOY,CAAAA,MAAM,CAACC,QAAP,CAAgBC,KAAhB,CAAsB,CAAtB,EAAyBC,KAAzB,CAA+B,GAA/B,EAAoC,CAApC,CAAP,CACH,CAHD,CAKA,cAAe,SAASC,CAAAA,MAAT,EAAkB,CAC7B,GAAMC,CAAAA,QAAQ,CAAGf,WAAW,EAA5B,CACA,GAAMgB,CAAAA,OAAO,CAAGnB,UAAU,EAA1B,CAEA;AACAF,SAAS,CAAC,UAAM,CACZsB,MAAM,CAACC,QAAP,CAAkB,UAAW,CAACC,cAAc,GAAG,CAA/C,CACA,GAAMA,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,EAAM,CACzB,GAAIC,QAAQ,CAACC,IAAT,CAAcC,SAAd,CAA0B,EAA1B,EAAgCF,QAAQ,CAACG,eAAT,CAAyBD,SAAzB,CAAqC,EAAzE,CAA6E,CAE7E,GAAIL,MAAM,CAACO,QAAP,CAAgBb,QAAhB,GAA6B,aAA7B,EACAM,MAAM,CAACO,QAAP,CAAgBb,QAAhB,GAA6B,WAD7B,EAEAM,MAAM,CAACO,QAAP,CAAgBb,QAAhB,GAA6B,QAF7B,EAGAM,MAAM,CAACO,QAAP,CAAgBb,QAAhB,GAA6B,cAH7B,EAIAM,MAAM,CAACO,QAAP,CAAgBb,QAAhB,GAA6B,SAJjC,CAI4C,CACpCS,QAAQ,CAACK,cAAT,CAAwB,aAAxB,EAAuCC,KAAvC,CAA6CC,MAA7C,CAAoD,OAApD,CACAP,QAAQ,CAACK,cAAT,CAAwB,gBAAxB,EAA0CC,KAA1C,CAAgDE,GAAhD,CAAoD,KAApD,CACAR,QAAQ,CAACK,cAAT,CAAwB,cAAxB,EAAwCC,KAAxC,CAA8CG,SAA9C,CAAwD,oBAAxD,CACH,CACJ,CAXD,IAWS,CACT,GAAIZ,MAAM,CAACO,QAAP,CAAgBb,QAAhB,GAA6B,aAA7B,EACAM,MAAM,CAACO,QAAP,CAAgBb,QAAhB,GAA6B,WAD7B,EAEAM,MAAM,CAACO,QAAP,CAAgBb,QAAhB,GAA6B,QAF7B,EAGAM,MAAM,CAACO,QAAP,CAAgBb,QAAhB,GAA6B,cAH7B,EAIAM,MAAM,CAACO,QAAP,CAAgBb,QAAhB,GAA6B,SAJjC,CAI4C,CACpCS,QAAQ,CAACK,cAAT,CAAwB,gBAAxB,EAA0CC,KAA1C,CAAgDE,GAAhD,CAAoD,MAApD,CACAR,QAAQ,CAACK,cAAT,CAAwB,aAAxB,EAAuCC,KAAvC,CAA6CC,MAA7C,CAAoD,KAApD,CACAP,QAAQ,CAACK,cAAT,CAAwB,cAAxB,EAAwCC,KAAxC,CAA8CG,SAA9C,CAAwD,eAAxD,CACH,CACJ,CACJ,CAvBD,CAwBH,CA1BQ,CA0BN,EA1BM,CAAT,CA6BA;AAlC6B,cAmCLnC,QAAQ,CAAC,IAAD,CAnCH,wCAmCtBoC,IAnCsB,eAmChBC,OAnCgB,eAqC7BpC,SAAS,CAAC,UAAM,CACZsB,MAAM,CAACe,UAAP,CAAoB,GAApB,EAA2BD,OAAO,CAAC,KAAD,CAAlC,CACH,CAFQ,CAEP,EAFO,CAAT,CAIA,GAAME,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,EAAM,CAExB,GAAIhB,MAAM,CAACe,UAAP,CAAoB,GAAxB,CAA6B,CACzB,GAAIF,IAAJ,CAAU,CACNV,QAAQ,CAACK,cAAT,CAAwB,cAAxB,EAAwCC,KAAxC,CAA8CG,SAA9C,CAAwD,oBAAxD,CACAT,QAAQ,CAACK,cAAT,CAAwB,cAAxB,EAAwCC,KAAxC,CAA8CQ,OAA9C,CAAsD,MAAtD,CACAH,OAAO,CAAC,KAAD,CAAP,CACH,CAJD,IAKK,CACDX,QAAQ,CAACK,cAAT,CAAwB,cAAxB,EAAwCC,KAAxC,CAA8CG,SAA9C,CAAwD,iBAAxD,CACAT,QAAQ,CAACK,cAAT,CAAwB,cAAxB,EAAwCC,KAAxC,CAA8CQ,OAA9C,CAAsD,OAAtD,CACAH,OAAO,CAAC,IAAD,CAAP,CACH,CAEJ,CAZD,IAcK,CACD,GAAID,IAAJ,CAAU,CACNV,QAAQ,CAACK,cAAT,CAAwB,cAAxB,EAAwCC,KAAxC,CAA8CG,SAA9C,CAAwD,oBAAxD,CACA,GAAIZ,MAAM,CAACO,QAAP,CAAgBb,QAAhB,CAAyBwB,QAAzB,CAAkC,SAAlC,CAAJ,CAAkD,CAC9Cf,QAAQ,CAACgB,sBAAT,CAAgC,MAAhC,EAAwC,CAAxC,EAA2CV,KAA3C,CAAiDG,SAAjD,CAA2D,kBAA3D,CACH,CACDE,OAAO,CAAC,KAAD,CAAP,CACH,CAND,IAOK,CACDX,QAAQ,CAACK,cAAT,CAAwB,cAAxB,EAAwCC,KAAxC,CAA8CG,SAA9C,CAAwD,iBAAxD,CACA,GAAIZ,MAAM,CAACO,QAAP,CAAgBb,QAAhB,CAAyBwB,QAAzB,CAAkC,SAAlC,CAAJ,CAAkD,CAC9Cf,QAAQ,CAACgB,sBAAT,CAAgC,MAAhC,EAAwC,CAAxC,EAA2CV,KAA3C,CAAiDG,SAAjD,CAA2D,mBAA3D,CACH,CACDE,OAAO,CAAC,IAAD,CAAP,CACH,CACJ,CACJ,CAhCD,CAmCA;AA5E6B,eA6EDrC,QAAQ,CAAC,KAAD,CA7EP,yCA6EtB2C,MA7EsB,eA6EdC,SA7Ec,eA+E7B;AACA,GAAMC,CAAAA,SAAS,CAAGxC,WAAW,CAAC,SAAAyC,KAAK,QAAIA,CAAAA,KAAK,CAACC,IAAN,CAAWC,IAAX,CAAgBC,MAApB,EAAN,CAA7B,CACA,GAAMC,CAAAA,QAAQ,CAAG7C,WAAW,CAAC,SAAAyC,KAAK,QAAIA,CAAAA,KAAK,CAACK,aAAN,CAAoBA,aAAxB,EAAN,CAA5B,CAEA;AAnF6B,eAoFGnD,QAAQ,CAAC,KAAD,CApFX,yCAoFtBoD,QApFsB,eAoFZC,WApFY,eAsF7B;AAtF6B,eAuFOrD,QAAQ,CAACkD,QAAQ,CAACD,MAAV,CAvFf,yCAuFtBK,UAvFsB,eAuFVC,aAvFU,eAyF7B;AACA,GAAMC,CAAAA,QAAQ,CAAGnD,WAAW,CAAC,SAAAyC,KAAK,QAAIA,CAAAA,KAAK,CAACU,QAAN,CAAeC,IAAnB,EAAN,CAA5B,CAEA;AA5F6B,eA6FLzD,QAAQ,CAAC,EAAD,CA7FH,0CA6FtByD,IA7FsB,gBA6FhBC,OA7FgB,gBA8F7B,GAAMC,CAAAA,OAAO,CAAGtD,WAAW,CAAC,SAAAyC,KAAK,QAAIA,CAAAA,KAAK,CAACc,IAAN,CAAWC,IAAf,EAAN,CAA3B,CAEA,GAAMC,CAAAA,MAAM,0FAAG,iBAAOC,GAAP,+LAEgBnD,CAAAA,GAAG,CAAC,CACvBoD,MAAM,CAAE,KADe,CAEvBC,GAAG,CAAE,OAFkB,CAGvBC,OAAO,CAAE,CACL,iCAA2BH,GAAG,CAAC,CAAD,CAAH,CAAOA,GAAlC,CADK,CAHc,CAAD,CAFnB,QAEDI,QAFC,eASP9C,QAAQ,CAACb,SAAS,CAAC2D,QAAQ,CAACV,IAAT,CAAcN,aAAf,CAAV,CAAR,CACAO,OAAO,CAACS,QAAQ,CAACV,IAAV,CAAP,CAVO,+EAYDW,WAZC,CAYaT,OAAO,CAAC,CAAD,CAAP,CAAWS,WAZxB,wBAagBxD,CAAAA,GAAG,CAAC,CACvBoD,MAAM,CAAE,MADe,CAEvBC,GAAG,CAAE,UAFkB,CAGvBC,OAAO,CAAE,CACL,iCAA2BE,WAA3B,CADK,CAHc,CAAD,CAbnB,SAaDC,QAbC,eAoBCN,IApBD,CAoBSM,QAAQ,CAACZ,IApBlB,CAoBCM,GApBD,CAqBP1C,QAAQ,CAACZ,WAAW,CAAC,CAAEsD,GAAG,CAAHA,IAAF,CAAOK,WAAW,CAAXA,WAAP,CAAD,CAAZ,CAAR,CACA7C,MAAM,CAACO,QAAP,CAAgBwC,MAAhB,GAtBO,oEAAH,kBAANR,CAAAA,MAAM,4CAAZ,CA0BA7D,SAAS,CAAC,UAAM,CACd,GAAMsE,CAAAA,QAAQ,CAAGC,WAAW,CAAC,UAAM,CAC/Bb,OAAO,CAACV,MAAR,GAAmB,CAAnB,EAAwBa,MAAM,CAACH,OAAD,CAA9B,CACH,CAF2B,CAEzB,MAFyB,CAA5B,CAGA,MAAO,kBAAMc,CAAAA,aAAa,CAACF,QAAD,CAAnB,EAAP,CACD,CALQ,CAKN,EALM,CAAT,CAOAtE,SAAS,CAAC,UAAM,CACZ0D,OAAO,CAACV,MAAR,GAAmB,CAAnB,EAAwBa,MAAM,CAACH,OAAD,CAA9B,CACH,CAFQ,CAEN,EAFM,CAAT,CAIA1D,SAAS,CAAC,UAAM,CACZsD,aAAa,CAACL,QAAQ,CAACwB,MAAT,CAAgB,SAACC,KAAD,CAAW,CACrC,MAAOA,CAAAA,KAAK,CAACC,OAAN,GAAkB,KAAzB,CACH,CAFa,EAEX3B,MAFU,CAAb,CAGH,CAJQ,CAAT,CAMA,mBACI,qDACI,2BAAK,OAAO,CAAEV,aAAd,CAA6B,EAAE,CAAC,cAAhC,EADJ,cAEI,2BAAK,SAAS,CAAC,aAAf,CAA6B,EAAE,CAAC,aAAhC,eACI,2BAAK,SAAS,CAAC,gBAAf,CAAgC,EAAE,CAAC,gBAAnC,eACI,8BAAQ,OAAO,CAAEA,aAAjB,CAAgC,EAAE,CAAC,YAAnC,eAAgD,yBAAG,SAAS,CAAC,gBAAb,SAAhD,CADJ,cAII,2BAAK,SAAS,CAAC,gBAAf,eACI,2BAAK,SAAS,CAAC,aAAf,CAA6B,GAAG,CAAE,+FAAlC,CAAmI,GAAG,CAAC,MAAvI,EADJ,cAEI,yBAAG,SAAS,CAAC,YAAb,cAFJ,CAJJ,CADJ,cAUI,2BAAK,SAAS,CAAC,sBAAf,CAAsC,EAAE,CAAC,cAAzC,eACI,2BAAK,SAAS,CAAC,6BAAf,eACI,2BAAK,SAAS,CAAC,eAAf,eACI,0BAAI,SAAS,CAAC,YAAd,CACI,EAAE,CAAC,cADP,EACuBzB,KAAK,CAACC,UAAU,EAAX,CAD5B,CADJ,CADJ,CADJ,cAOI,2BAAK,SAAS,CAAC,8BAAf,CAA8C,EAAE,CAAC,YAAjD,eACI,yBAAG,SAAS,CAAC,gBAAb,CAA8B,EAAE,CAAC,aAAjC,WADJ,cAEI,6BAAO,SAAS,CAAC,YAAjB,CAA8B,EAAE,CAAC,eAAjC,CAAiD,IAAI,CAAC,MAAtD,CAA6D,WAAW,CAAC,WAAzE,EAFJ,CAPJ,cAWI,2BAAK,SAAS,CAAC,eAAf,eACI,2BAAK,SAAS,CAAC,QAAf,eACI,2BAAK,SAAS,CAAC,+BAAf,eACI,2BAAK,SAAS,CAAC,gBAAf,eACI,2BAAK,SAAS,mBAAc8B,SAAS,GAAK,CAAd,CACpB,gBADoB,CACD,EADb,CAAd,eAEI,6BAAIA,SAAJ,CAFJ,CADJ,cAII,yBAAG,OAAO,CAAE,yBAAMD,CAAAA,SAAS,CAAC,IAAD,CAAf,EAAZ,CACI,SAAS,CAAC,gBADd,WAJJ,CAOQD,MAAM,eACF,oBAAC,OAAD,EAAS,OAAO,CAAE,yBAAMC,CAAAA,SAAS,CAAC,KAAD,CAAf,EAAlB,EARZ,CADJ,cAYI,2BAAK,SAAS,0BAAoBe,OAAO,CAACV,MAAR,GAAmB,CAAnB,CAAuB,UAAvB,CAAoC,EAAxD,CAAd,eACI,2BAAK,SAAS,mBAAcU,OAAO,CAACV,MAAR,GAAmB,CAAnB,CAAuB,kBAAvB,CAA4C,EAA1D,aAAkEK,UAAU,GAAK,CAAf,CAAmB,gBAAnB,CAAsC,EAAxG,CAAd,eACI,yBAAG,SAAS,CAAC,eAAb,EAA8BA,UAA9B,CADJ,CADJ,cAGI,oBAAC,IAAD,EAAM,OAAO,CAAE,kBAAM,CAACK,OAAO,CAACV,MAAR,GAAmB,CAAnB,EACd5B,QAAQ,CAACd,SAAS,CAAC,UAAD,CAAV,CADM,CAEb,CAFT,CAGI,EAAE,CAAC,OAHP,eAII,yBAAG,SAAS,CAAC,gBAAb,uBAJJ,CAHJ,CAZJ,CADJ,cAwBI,2BAAK,SAAS,CAAC,+BAAf,eACI,8BAAQ,OAAO,CAAE,kBAAM,CACnBoD,OAAO,CAACV,MAAR,GAAmB,CAAnB,EACII,WAAW,CAAC,IAAD,CADf,CAEH,CAHD,CAII,SAAS,CAAC,cAJd,eAKI,2BAAK,KAAK,CAAEI,IAAI,CAACoB,QAAjB,CAA2B,SAAS,CAAC,mBAArC,CACI,GAAG,WAAKpB,IAAI,CAACR,MAAL,GAAgB,CAAhB,CAAoBO,QAAQ,CAACsB,OAA7B,CAAuCrB,IAAI,CAACqB,OAAjD,CADP,CAEI,GAAG,CAAC,aAFR,EALJ,CADJ,CAxBJ,CADJ,CAXJ,CAVJ,CAFJ,CAgEQ1B,QAAQ,eACJ,oBAAC,KAAD,mBACI,oBAAC,cAAD,EAAgB,IAAI,CAAE,CAClB,SAAU,oBADQ,CAElB,gBAAiB,eAFC,CAGlB,OAAQ,SAHU,CAAtB,CAIG,OAAO,CAAE,yBAAMC,CAAAA,WAAW,CAAC,KAAD,CAAjB,EAJZ,EADJ,CAjEZ,CADJ,CA4EH","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Link, useHistory, useLocation } from 'react-router-dom';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { changeUrl } from 'store/ducks/links';\nimport { loadNotif } from 'store/ducks/notifications';\nimport { refreshAuth } from 'store/ducks/auth';\n\nimport SettingsDialog from '../aux/SettingsDialog/SettingsDialog';\nimport Modal from '../aux/Modal';\nimport api from '../../services/api';\n\nimport './styles.scss';\n\nimport Clipper from '../aux/Clipper/Clipper';\n\n//Page names\nconst Pages = {\n    'explore' : 'Explorar',\n    'account' : 'Conta',\n    'home' : 'Perfil',\n    'lessons' : 'Aulas',\n    'lesson' : 'Aula'\n};\nconst CurrentUrl = () => {\n    let active = useLocation();\n    return active.pathname.slice(1).split('/')[0];\n}\n\nexport default function Header() {\n    const dispatch = useDispatch();\n    const history = useHistory();\n\n    //shrink on scroll\n    useEffect(() => {\n        window.onscroll = function() {shrinkOnScroll()};\n        const shrinkOnScroll = () => {\n            if (document.body.scrollTop > 80 || document.documentElement.scrollTop > 80) {\n\n            if (window.location.pathname !== '/motivation' &&\n                window.location.pathname !== '/register' &&\n                window.location.pathname !== '/login' &&\n                window.location.pathname !== '/forgot_pass' &&\n                window.location.pathname !== '/logout') {\n                    document.getElementById(\"header_main\").style.height=\"3.5em\"\n                    document.getElementById(\"menu_container\").style.top=\"4px\"\n                    document.getElementById(\"sidebar_menu\").style.transform=\"translateY(-1.5em)\"\n                }\n            }   else {\n            if (window.location.pathname !== '/motivation' &&\n                window.location.pathname !== '/register' &&\n                window.location.pathname !== '/login' &&\n                window.location.pathname !== '/forgot_pass' &&\n                window.location.pathname !== '/logout') {\n                    document.getElementById(\"menu_container\").style.top=\"16px\"\n                    document.getElementById(\"header_main\").style.height=\"5em\"\n                    document.getElementById(\"sidebar_menu\").style.transform=\"translateY(0)\"\n                }\n            }\n        }\n    }, [])\n\n\n    //hamburguer\n    const [side, setSide] = useState(true)\n\n    useEffect(() => {\n        window.innerWidth < 850 && setSide(false)\n    },[])\n\n    const toggleSidebar = () => {\n\n        if (window.innerWidth < 850) {\n            if (side) { \n                document.getElementById(\"main_sidebar\").style.transform=\"translateX(-220px)\"\n                document.getElementById(\"side-overlay\").style.display=\"none\";\n                setSide(false)\n            }\n            else {\n                document.getElementById(\"main_sidebar\").style.transform=\"translateX(0px)\"\n                document.getElementById(\"side-overlay\").style.display=\"block\";\n                setSide(true)\n            }\n\n        }\n\n        else {\n            if (side) { \n                document.getElementById(\"main_sidebar\").style.transform=\"translateX(-220px)\"\n                if (window.location.pathname.includes('explore')) {\n                    document.getElementsByClassName(\"prev\")[0].style.transform=\"translateX(10px)\"\n                }\n                setSide(false)\n            }\n            else {\n                document.getElementById(\"main_sidebar\").style.transform=\"translateX(0px)\"\n                if (window.location.pathname.includes('explore')) {\n                    document.getElementsByClassName(\"prev\")[0].style.transform=\"translateX(230px)\"\n                }\n                setSide(true)\n            }\n        }\n    }\n\n\n    //Buttons dialog\n    const [dialog, setDialog] = useState(false);\n\n    //Buttons counter indicator\n    const cartCount = useSelector(state => state.shop.cart.length);\n    const allNotif = useSelector(state => state.notifications.notifications)\n\n    //Profile button\n    const [settings, setSettings] = useState(false)\n\n    //Notif Counter\n    const [notifCount, setnotifCount] = useState(allNotif.length);\n\n    //Defaults\n    const defaults = useSelector(state => state.defaults.data)\n\n    //Data fetching\n    const [data, setData] = useState([])\n    const authKey = useSelector(state => state.auth.keys)\n\n    const hitApi = async (key) => {\n        try{\n            const response = await api({\n                method: 'get',\n                url: '/user',\n                headers: {\n                    'Authorization': `Bearer ${key[0].key}`\n                }\n            })\n            dispatch(loadNotif(response.data.notifications))\n            setData(response.data)\n        } catch(e){\n            const refresh_key = authKey[0].refresh_key\n            const onExpire = await api({\n                method: 'post',\n                url: '/refresh',\n                headers: {\n                    'Authorization': `Bearer ${refresh_key}`\n                }\n            })\n            const { key } = onExpire.data\n            dispatch(refreshAuth({ key, refresh_key }))\n            window.location.reload()\n        }\n    }\n\n    useEffect(() => {\n      const interval = setInterval(() => {\n          authKey.length !== 0 && hitApi(authKey)\n      }, 100000);\n      return () => clearInterval(interval);\n    }, []);\n\n    useEffect(() => {\n        authKey.length !== 0 && hitApi(authKey)\n    }, [])\n\n    useEffect(() => {\n        setnotifCount(allNotif.filter((value) => {\n            return value.is_read === false\n        }).length)\n    })\n\n    return (\n        <>\n            <div onClick={toggleSidebar} id=\"side-overlay\"></div>\n            <div className=\"header-main\" id=\"header_main\">\n                <div className=\"menu-container\" id=\"menu_container\">\n                    <button onClick={toggleSidebar} id=\"hamburguer\"><i className=\"material-icons\">\n                        menu\n                    </i></button>\n                    <div className=\"sanguetsu-mark\">\n                        <img className=\"header-logo\" src={\"https://ikebana-app-content.s3-sa-east-1.amazonaws.com/static/mainlogo_transparent_notext.png\"} alt=\"logo\"/>\n                        <p className=\"logo-title\">SANGUETSU</p>\n                    </div>\n                </div>\n                <div className=\"header-main__content\" id=\"header_title\">\n                    <div className=\"header-main__content--title\">\n                        <div className=\"title-limiter\">\n                            <h1 className=\"page-title\" \n                                id=\"header_title\">{Pages[CurrentUrl()]}</h1>\n                        </div>\n                    </div>\n                    <div className=\"header-main__content--search\" id=\"search_box\">\n                        <i className=\"material-icons\" id=\"search_icon\">search</i>\n                        <input className=\"search-box\" id=\"search_inside\" type=\"text\" placeholder=\"Pesquisar\"/>\n                    </div>\n                    <div className=\"right-wrapper\">\n                        <div className=\"shrink\">\n                            <div className=\"header-main__content--buttons\">\n                                <div className=\"button-wrapper\">\n                                    <div className={`counter ${ cartCount === 0 ?\n                                            'counter-hidden' : '' }`}>\n                                        <p>{cartCount}</p></div>\n                                    <i onClick={() => setDialog(true)} \n                                        className=\"material-icons\">redeem</i>\n                                    {\n                                        dialog &&\n                                            <Clipper handler={() => setDialog(false)} />\n                                    }\n                                </div>\n                                <div className={`button-wrapper ${authKey.length === 0 ? 'disabled' : ''}`}>\n                                    <div className={`counter ${ authKey.length === 0 ? 'counter-disabled' : '' } ${ notifCount === 0 ? 'counter-hidden' : '' }`}>\n                                        <p className=\"notif-counter\">{notifCount}</p></div>\n                                    <Link onClick={() => {authKey.length !== 0 &&\n                                            dispatch(changeUrl('messages'))\n                                            }} \n                                        to=\"/home\">\n                                        <i className=\"material-icons\">notifications_none</i>\n                                    </Link>\n                                </div>\n                            </div>\n                            <div className=\"header-main__content--profile\">\n                                <button onClick={() => {\n                                    authKey.length !== 0 &&\n                                        setSettings(true)\n                                }} \n                                    className=\"profile__btn\">\n                                    <img title={data.username} className=\"profile__btn--img\" \n                                        src={`${data.length === 0 ? defaults.picture : data.picture}`}\n                                        alt=\"Profile pic\"/>\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            {\n                settings &&\n                    <Modal>\n                        <SettingsDialog data={{\n                            'Perfil': '/home/arrangements',\n                            'Configurações': '/account/edit',\n                            'Sair': '/logout'\n                        }} handler={() => setSettings(false)}/>\n                    </Modal>\n            }\n        </>\n    );\n}\n\n"]},"metadata":{},"sourceType":"module"}