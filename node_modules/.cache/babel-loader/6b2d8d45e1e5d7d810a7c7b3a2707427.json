{"ast":null,"code":"import _regeneratorRuntime from\"/home/fabricio7p/Documents/Projects/Ikebana/Frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/fabricio7p/Documents/Projects/Ikebana/Frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/fabricio7p/Documents/Projects/Ikebana/Frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{Link,useHistory}from'react-router-dom';import api from'../../../services/api';import{storeAuth}from'store/ducks/auth';import{useDispatch,useSelector}from'react-redux';import{useForm}from'react-hook-form';import Modal from'../../aux/Modal';import ErrorDialog from'../../aux/ErrorDialog/ErrorDialog';import IndexFooter from'./IndexFooter/IndexFooter';import'./styles.scss';export default function Login(){var _useForm=useForm(),register=_useForm.register,handleSubmit=_useForm.handleSubmit,errors=_useForm.errors;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loading2=_useState4[0],setLoading2=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),error=_useState6[0],setError=_useState6[1];var dispatch=useDispatch();var history=useHistory();var authKey=useSelector(function(state){return state.auth.keys;});var onSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref){var email,password,response,_response$data,key,refresh_key;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:email=_ref.email,password=_ref.password;setLoading(true);_context.prev=2;_context.next=5;return api({method:'post',url:'/login',data:{email:email,password:password}});case 5:response=_context.sent;_response$data=response.data,key=_response$data.key,refresh_key=_response$data.refresh_key;dispatch(storeAuth({key:key,refresh_key:refresh_key}));history.push('/explore');_context.next=16;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](2);_context.t0.message.includes('403')&&setError('E-mail inserido ainda não foi confirmado');_context.t0.message.includes('401')&&setError('E-mail ou senha inválido(s)');_context.t0.message.includes('400')&&setError('E-mail já registrado, clique em entrar usando sua conta Google');case 16:_context.prev=16;setLoading(false);return _context.finish(16);case 19:case\"end\":return _context.stop();}}},_callee,null,[[2,11,16,19]]);}));return function onSubmit(_x){return _ref2.apply(this,arguments);};}();var oAuth=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setLoading2(true);_context2.prev=1;_context2.next=4;return api({method:'get',url:'/oauth_login'});case 4:response=_context2.sent;console.log(response.data.request_uri);window.location.replace(response.data.request_uri);_context2.next=12;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](1);console.log(_context2.t0);case 12:_context2.prev=12;setLoading2(false);return _context2.finish(12);case 15:case\"end\":return _context2.stop();}}},_callee2,null,[[1,9,12,15]]);}));return function oAuth(){return _ref3.apply(this,arguments);};}();useEffect(function(){if(authKey.length!==0){history.push('/explore');}},[]);return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"login\"},/*#__PURE__*/React.createElement(\"section\",{className:\"wrapper\"},/*#__PURE__*/React.createElement(\"div\",{className:\"login-main\"},/*#__PURE__*/React.createElement(\"img\",{className:\"ike-logo\",src:\"https://ikebana-app-content.s3-sa-east-1\"+\".amazonaws.com/static/mainlogo.png\",alt:\"logo\"}),/*#__PURE__*/React.createElement(\"form\",{onSubmit:handleSubmit(onSubmit)},/*#__PURE__*/React.createElement(\"div\",{className:\"login-main__inputs\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input-wrapper\"},/*#__PURE__*/React.createElement(\"input\",{className:\"login-input\",name:\"email\",type:\"text\",ref:register({required:true}),placeholder:\"Usu\\xE1rio\"}),errors.email&&/*#__PURE__*/React.createElement(\"div\",{title:\"Campo necess\\xE1rio\",className:\"validation-overlay\"},/*#__PURE__*/React.createElement(\"i\",{className:\"material-icons\"},\"error_outline\"))),/*#__PURE__*/React.createElement(\"input\",{className:\"login-input\",name:\"password\",type:\"password\",ref:register,placeholder:\"Senha\"})),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"login-btn\"},loading===true?/*#__PURE__*/React.createElement(\"div\",{className:\"sizer\"},/*#__PURE__*/React.createElement(\"div\",{className:\"lds-ellipsis\"},/*#__PURE__*/React.createElement(\"div\",null),/*#__PURE__*/React.createElement(\"div\",null),/*#__PURE__*/React.createElement(\"div\",null),/*#__PURE__*/React.createElement(\"div\",null))):/*#__PURE__*/React.createElement(\"p\",null,\"Entrar\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"login-main__spacer\"},/*#__PURE__*/React.createElement(\"div\",{className:\"spacer-h\"}),/*#__PURE__*/React.createElement(\"p\",{className:\"login-main__spacer--text\"},\"OU\"),/*#__PURE__*/React.createElement(\"div\",{className:\"spacer-h\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"login-main__external\"},/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return oAuth();},className:\"login-google\"},loading2===true?/*#__PURE__*/React.createElement(\"div\",{className:\"sizer\"},/*#__PURE__*/React.createElement(\"div\",{className:\"lds-ellipsis\"},/*#__PURE__*/React.createElement(\"div\",null),/*#__PURE__*/React.createElement(\"div\",null),/*#__PURE__*/React.createElement(\"div\",null),/*#__PURE__*/React.createElement(\"div\",null))):/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"p\",{className:\"login-google--text\"},\"Entrar usando\"),/*#__PURE__*/React.createElement(\"img\",{className:\"google-logo\",src:\"https://image.flaticon.com/icons/svg/281/281764.svg\",alt:\"Google\"})))),/*#__PURE__*/React.createElement(\"div\",{className:\"login-main__forgot\"},/*#__PURE__*/React.createElement(\"button\",{className:\"forgot-btn\"},/*#__PURE__*/React.createElement(Link,{to:\"/forgot_pass\"},\"Esqueceu sua senha?\")))),/*#__PURE__*/React.createElement(\"div\",{className:\"login-bottom\"},/*#__PURE__*/React.createElement(\"p\",{className:\"login-bottom--text\"},\"N\\xE3o tem uma conta?\",/*#__PURE__*/React.createElement(\"button\",{className:\"register-btn\"},/*#__PURE__*/React.createElement(Link,{to:\"/register\"},\"Criar\")))),/*#__PURE__*/React.createElement(\"div\",{className:\"get-info\"},\"Em breve...\"),/*#__PURE__*/React.createElement(\"div\",{className:\"login-get-btn\"},/*#__PURE__*/React.createElement(\"button\",{className:\"appstore-btn\"},/*#__PURE__*/React.createElement(\"img\",{src:\"https://ikebana-app-content.s3-sa-east-1.amazonaws.com/static/app-store-badge.png\",alt:\"App store\"})),/*#__PURE__*/React.createElement(\"button\",{className:\"playstore-btn\"},/*#__PURE__*/React.createElement(\"img\",{src:\"https://play.google.com/intl/pt-BR/badges/static/images/badges/pt-br_badge_web_generic.png\",alt:\"Play store\"})))),/*#__PURE__*/React.createElement(IndexFooter,null)),error&&/*#__PURE__*/React.createElement(Modal,null,/*#__PURE__*/React.createElement(ErrorDialog,{handler:function handler(){return setError(false);},value:error})));}","map":{"version":3,"sources":["/home/fabricio7p/Documents/Projects/Ikebana/Frontend/src/components/pages/Login/Login.js"],"names":["React","useState","useEffect","Link","useHistory","api","storeAuth","useDispatch","useSelector","useForm","Modal","ErrorDialog","IndexFooter","Login","register","handleSubmit","errors","loading","setLoading","loading2","setLoading2","error","setError","dispatch","history","authKey","state","auth","keys","onSubmit","email","password","method","url","data","response","key","refresh_key","push","message","includes","oAuth","console","log","request_uri","window","location","replace","length","required"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Link, useHistory } from 'react-router-dom';\nimport api from '../../../services/api';\nimport { storeAuth  } from 'store/ducks/auth';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useForm } from 'react-hook-form';\n\nimport Modal from '../../aux/Modal';\nimport ErrorDialog from '../../aux/ErrorDialog/ErrorDialog';\n\nimport IndexFooter from './IndexFooter/IndexFooter';\n\nimport './styles.scss';\n\nexport default function Login() {\n    const { register, handleSubmit, errors } = useForm();\n    const [loading, setLoading] = useState(false);\n    const [loading2, setLoading2] = useState(false);\n    const [error, setError] = useState(false);\n\n    const dispatch = useDispatch();\n    const history = useHistory();\n    const authKey = useSelector(state => state.auth.keys)\n\n    const onSubmit = async ({ email, password }) => {\n        setLoading(true)\n        try {\n            const response = await api({\n                method: 'post',\n                url: '/login',\n                data: { email, password },\n            })\n            const { key, refresh_key } = response.data\n            dispatch(storeAuth({key, refresh_key}))\n            history.push('/explore')\n        } catch(e) {\n            e.message.includes('403') && setError('E-mail inserido ainda não foi confirmado')\n            e.message.includes('401') && setError('E-mail ou senha inválido(s)')\n            e.message.includes('400') && setError('E-mail já registrado, clique em entrar usando sua conta Google')\n        } finally {\n            setLoading(false)\n        }\n    }\n\n    const oAuth = async () => {\n        setLoading2(true)\n        try {\n            const response = await api({\n                method: 'get',\n                url: '/oauth_login'\n            })\n            console.log(response.data.request_uri)\n            window.location.replace(response.data.request_uri)\n        } catch(e) {\n            console.log(e)\n        } finally {\n            setLoading2(false)\n        }\n    }\n\n\n    useEffect(() => {\n        if (authKey.length !== 0) {\n            history.push('/explore')\n        } \n    },[])\n\n    return(\n        <>\n            <div className=\"login\">\n                <section className=\"wrapper\">\n                    <div className=\"login-main\">\n                        <img className=\"ike-logo\" \n                            src={\"https://ikebana-app-content.s3-sa-east-1\"+\n                                    \".amazonaws.com/static/mainlogo.png\"} alt=\"logo\"/>\n\n                        <form onSubmit={handleSubmit(onSubmit)}>\n                            <div className=\"login-main__inputs\">\n                                <div className=\"input-wrapper\">\n                                    <input className=\"login-input\" name=\"email\" \n                                        type=\"text\" ref={ register({ required: true }) } \n                                        placeholder=\"Usuário\"/>\n                                    {errors.email && <div title=\"Campo necessário\" \n                                        className=\"validation-overlay\"><i className=\"material-icons\">\n                                            error_outline</i></div>}\n                                </div>\n                                <input  className=\"login-input\" name=\"password\" \n                                    type=\"password\" ref={ register } placeholder=\"Senha\" />\n                            </div>\n                            <button type=\"submit\" className=\"login-btn\">\n                                {\n                                    loading === true ? <div className=\"sizer\">\n                                        <div className=\"lds-ellipsis\"><div></div>\n                                            <div></div><div></div><div></div></div>\n                                    </div>\n                                    :\n                                    <p>Entrar</p>\n                                }\n                            </button>\n                        </form>\n                        <div className=\"login-main__spacer\">\n                            <div className=\"spacer-h\"></div>\n                            <p className=\"login-main__spacer--text\">OU</p>\n                            <div className=\"spacer-h\"></div>\n                        </div>\n                        <div className=\"login-main__external\">\n                            <button onClick={() => oAuth()} className=\"login-google\">\n                                {\n                                    loading2 === true ? <div className=\"sizer\">\n                                        <div className=\"lds-ellipsis\"><div></div>\n                                            <div></div><div></div><div></div></div>\n                                    </div>\n                                       :\n                                       <>\n                                    <p className=\"login-google--text\">Entrar usando</p>\n                                    <img className=\"google-logo\" \n                                        src=\"https://image.flaticon.com/icons/svg/281/281764.svg\" \n                                        alt=\"Google\" />\n                                       </>\n                                }\n                            </button>\n                        </div>\n                        <div className=\"login-main__forgot\">\n                            <button className=\"forgot-btn\">\n                                <Link to=\"/forgot_pass\">\n                                    Esqueceu sua senha?\n                                </Link>\n                            </button>\n                        </div>\n                    </div>\n                    <div className=\"login-bottom\">\n                        <p className=\"login-bottom--text\">Não tem uma conta?\n                            <button className=\"register-btn\">\n                                <Link to=\"/register\">Criar</Link>\n                            </button>\n                        </p>\n                    </div>\n                    <div className=\"get-info\">Em breve...</div>\n                    <div className=\"login-get-btn\">\n                        <button className=\"appstore-btn\">\n                            <img src=\"https://ikebana-app-content.s3-sa-east-1.amazonaws.com/static/app-store-badge.png\" alt=\"App store\" />\n                        </button>\n                        <button className=\"playstore-btn\">\n                            <img src=\"https://play.google.com/intl/pt-BR/badges/static/images/badges/pt-br_badge_web_generic.png\" alt=\"Play store\" />\n                        </button>\n                    </div>\n                </section>\n                <IndexFooter />\n            </div>\n            {\n                error &&\n                    <Modal>\n                        <ErrorDialog handler={() => setError(false)} value={error}/>\n                    </Modal>\n            }\n        </>\n    );\n}\n"]},"metadata":{},"sourceType":"module"}