{"ast":null,"code":"import _regeneratorRuntime from\"/home/fabricio7p/Documents/Projects/Ikebana/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/fabricio7p/Documents/Projects/Ikebana/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/fabricio7p/Documents/Projects/Ikebana/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{useDispatch,useSelector}from'react-redux';import api from'services/api';import{useForm}from'react-hook-form';import Modal from'../../../../aux/Modal';import ErrorDialog from'../../../../aux/ErrorDialog/ErrorDialog';import InfoDialog from'../../../../aux/InfoDialog/InfoDialog';import'./styles.scss';export default function NewProject(){//toggle allow button only if arrangement is selected\nvar _useState=useState(false),_useState2=_slicedToArray(_useState,2),allow=_useState2[0],setAllow=_useState2[1];//forms\nvar _useForm=useForm(),register=_useForm.register,handleSubmit=_useForm.handleSubmit,errors=_useForm.errors,watch=_useForm.watch;//store select\nvar authKey=useSelector(function(state){return state.auth.keys;});var userData=useSelector(function(state){return state.account.userData[0];});//dialog\nvar _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),error=_useState4[0],setError=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),info=_useState6[0],setInfo=_useState6[1];//feeding data\nvar _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),data=_useState8[0],setData=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),loading=_useState10[0],setLoading=_useState10[1];//picture inputs\nvar _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),file1=_useState12[0],setFile1=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),file2=_useState14[0],setFile2=_useState14[1];var _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),file3=_useState16[0],setFile3=_useState16[1];var handleInputChange=function handleInputChange(e){var inputNum=e.target.name.split('file')[1];var file=e.target.files[0];if(!file){setError('Selecione alguma foto');return void 0;}if((file.size/1024/1024).toFixed()>5){setError('Selecione um arquivo menor que 5MB');return void 0;}if(!['image/png','image/jpeg'].includes(file.type)){setError('Formato inválido, selecione apenas imagens JPG ou PNG');return void 0;}var preview=URL.createObjectURL(file);switch(inputNum){case'1':{setFile1({file:file,preview:preview});break;}case'2':{setFile2({file:file,preview:preview});break;}case'3':{setFile3({file:file,preview:preview});break;}default:{return void 0;}}};var onSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref){var project_type,project_title,project_desc,project_allow,project_video,formData,response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:project_type=_ref.project_type,project_title=_ref.project_title,project_desc=_ref.project_desc,project_allow=_ref.project_allow,project_video=_ref.project_video;setLoading(true);formData=new FormData();_context.prev=3;formData.append('project_type',project_type);formData.append('project_title',project_title);formData.append('project_desc',project_desc);formData.append('project_video',project_video);formData.append('project_allow',project_allow);formData.append('file1',file1.file);formData.append('file2',file2.file);formData.append('file3',file3.file);_context.next=14;return api({method:'post',url:'/projects',headers:{'Authorization':\"Bearer \".concat(authKey[0].key),'Content-Type':'multipart/form-data'},data:formData});case 14:response=_context.sent;response.data&&setInfo('Projeto criado com sucesso.');console.log(response.data);_context.next=22;break;case 19:_context.prev=19;_context.t0=_context[\"catch\"](3);setError('Um projeto com este nome já existe');case 22:_context.prev=22;setLoading(false);return _context.finish(22);case 25:case\"end\":return _context.stop();}}},_callee,null,[[3,19,22,25]]);}));return function onSubmit(_x){return _ref2.apply(this,arguments);};}();useEffect(function(){setFile1({preview:''});setFile2({preview:''});setFile3({preview:''});},[]);return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"new\"},/*#__PURE__*/React.createElement(\"div\",{className:\"new__header\"},/*#__PURE__*/React.createElement(\"p\",{className:\"password__header--title\"},\"Criar um novo projeto.\")),/*#__PURE__*/React.createElement(\"form\",{onSubmit:handleSubmit(onSubmit)},/*#__PURE__*/React.createElement(\"div\",{className:\"new__inputs\"},/*#__PURE__*/React.createElement(\"p\",{className:\"new__inputs--desc\"},\"Informa\\xE7\\xF5es do projeto\"),/*#__PURE__*/React.createElement(\"div\",{className:\"new__inputs--container acc-field\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"project-name\",className:\"input-label acc-field__title\"},\"Tipo\"),errors.project_type&&/*#__PURE__*/React.createElement(\"div\",{title:\"Voc\\xEA deve escolher um tipo\",className:\"validation-overlay-new\"},/*#__PURE__*/React.createElement(\"i\",{className:\"material-icons\"},\"error_outline\")),/*#__PURE__*/React.createElement(\"div\",{className:\"project-type\"},/*#__PURE__*/React.createElement(\"label\",{className:\"project-type__label\",onClick:function onClick(){return setAllow(true);},htmlFor:\"arrangement\"},\"Arranjo\"),/*#__PURE__*/React.createElement(\"input\",{className:\"project-type__input\",onClick:function onClick(){return setAllow(true);},value:\"arrangement\",type:\"radio\",id:\"arrangement\",name:\"project_type\",ref:register({required:true})}),/*#__PURE__*/React.createElement(\"label\",{className:\"project-type__label\",onClick:function onClick(){return setAllow(false);},htmlFor:\"lesson\"},\"Aula\"),/*#__PURE__*/React.createElement(\"input\",{className:\"project-type__input\",onClick:function onClick(){return setAllow(false);},value:\"lesson\",type:\"radio\",id:\"lesson\",ref:register({required:true}),name:\"project_type\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"new__inputs--container acc-field\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"project-name\",className:\"input-label acc-field__title\"},\"Nome do Projeto\"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",ref:register({required:true,minLength:6,maxLength:35}),className:\"account-input\",name:\"project_title\",id:\"project-name\"}),errors.project_title&&/*#__PURE__*/React.createElement(\"div\",{title:\"M\\xEDnimo de 6 caracteres e M\\xE1ximo 35\",className:\"validation-overlay-new\"},/*#__PURE__*/React.createElement(\"i\",{className:\"material-icons\"},\"error_outline\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"new__inputs--container acc-field\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"project-desc\",className:\"input-label acc-field__title\"},\"Descri\\xE7\\xE3o\"),/*#__PURE__*/React.createElement(\"textarea\",{id:\"project-desc\",className:\"account-input\",ref:register({required:true,minLength:20}),placeholder:\"Texto descritivo ou explicativo\",name:\"project_desc\"}),errors.project_desc&&/*#__PURE__*/React.createElement(\"div\",{title:\"\\xC9 preciso incluir uma descri\\xE7\\xE3o de no m\\xEDnimo 20 caract\\xE9res\",className:\"validation-overlay-new\"},/*#__PURE__*/React.createElement(\"i\",{className:\"material-icons\"},\"error_outline\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"new__inputs--container acc-field\"},/*#__PURE__*/React.createElement(\"label\",{style:{marginTop:\"2px\"},htmlFor:\"project-name\",className:\"input-label acc-field__title\"},\"Solicita\\xE7\\xF5es\"),/*#__PURE__*/React.createElement(\"div\",{className:\"project-type \".concat(!allow&&'hidden-allow')},/*#__PURE__*/React.createElement(\"label\",{className:\"project-type__label\",htmlFor:\"project_allow\"},\"Permitir?\"),/*#__PURE__*/React.createElement(\"input\",{className:\"project-type__input\",id:\"project_allow\",type:\"checkbox\",name:\"project_allow\",ref:register()}),/*#__PURE__*/React.createElement(\"i\",{title:\"Permitir que outras pessoas solicitem este arranjo.\",className:\"material-icons help-allow\"},\"help\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"new__inputs--container acc-field\"},/*#__PURE__*/React.createElement(\"label\",{className:\"input-label acc-field__title\"},\"Fotos do Projeto\"),/*#__PURE__*/React.createElement(\"div\",{className:\"picture-wrapper\"},/*#__PURE__*/React.createElement(\"div\",{className:\"picture-container\"},/*#__PURE__*/React.createElement(\"button\",{className:\"picture-container__btn\"},/*#__PURE__*/React.createElement(\"button\",{className:\"close-overlay \".concat(!file1.preview?'inactive':''),onClick:function onClick(){return setFile1([]);}},/*#__PURE__*/React.createElement(\"i\",{className:\"material-icons\"},\"close\")),/*#__PURE__*/React.createElement(\"img\",{src:file1.preview,className:\"img-preview\",alt:\"\"}),/*#__PURE__*/React.createElement(\"i\",{className:\"material-icons\"},\"add\"),/*#__PURE__*/React.createElement(\"input\",{type:\"file\",ref:register(),onChange:handleInputChange,className:\"picture-input\",name:\"file1\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"picture-container\"},/*#__PURE__*/React.createElement(\"button\",{className:\"picture-container__btn\"},/*#__PURE__*/React.createElement(\"button\",{className:\"close-overlay \".concat(!file2.preview?'inactive':''),onClick:function onClick(){return setFile2([]);}},/*#__PURE__*/React.createElement(\"i\",{className:\"material-icons\"},\"close\")),/*#__PURE__*/React.createElement(\"img\",{src:file2.preview,className:\"img-preview\",alt:\"\"}),/*#__PURE__*/React.createElement(\"i\",{className:\"material-icons\"},\"add\"),/*#__PURE__*/React.createElement(\"input\",{type:\"file\",ref:register(),onChange:handleInputChange,className:\"picture-input\",name:\"file2\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"picture-container\"},/*#__PURE__*/React.createElement(\"button\",{className:\"picture-container__btn\"},/*#__PURE__*/React.createElement(\"button\",{className:\"close-overlay \".concat(!file3.preview?'inactive':''),onClick:function onClick(){return setFile3([]);}},/*#__PURE__*/React.createElement(\"i\",{className:\"material-icons\"},\"close\")),/*#__PURE__*/React.createElement(\"img\",{src:file3.preview,className:\"img-preview\",alt:\"\"}),/*#__PURE__*/React.createElement(\"i\",{className:\"material-icons\"},\"add\"),/*#__PURE__*/React.createElement(\"input\",{type:\"file\",ref:register(),onChange:handleInputChange,className:\"picture-input\",name:\"file3\"}))))),/*#__PURE__*/React.createElement(\"p\",{className:\"new__inputs--desc\"},\"Videoaula\"),/*#__PURE__*/React.createElement(\"div\",{className:\"new__inputs--container acc-field\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"project-video\",className:\"input-label acc-field__title\"},\"Link do Video\"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",className:\"account-input\",id:\"project-video\",ref:register(),name:\"project_video\",placeholder:\"Somente links do YouTube\"})),/*#__PURE__*/React.createElement(\"button\",{className:\"app-btn btn-filled\"},loading===true?/*#__PURE__*/React.createElement(\"div\",{className:\"sizer\"},/*#__PURE__*/React.createElement(\"div\",{class:\"lds-ellipsis\"},/*#__PURE__*/React.createElement(\"div\",null),/*#__PURE__*/React.createElement(\"div\",null),/*#__PURE__*/React.createElement(\"div\",null),/*#__PURE__*/React.createElement(\"div\",null))):/*#__PURE__*/React.createElement(\"p\",null,\"Concluir\"))))),error&&/*#__PURE__*/React.createElement(Modal,null,/*#__PURE__*/React.createElement(ErrorDialog,{value:error,handler:function handler(){setError(false);}})),info&&/*#__PURE__*/React.createElement(Modal,null,/*#__PURE__*/React.createElement(InfoDialog,{value:info,handler:function handler(){setInfo(false);window.location.pathname='/home';}})));}","map":{"version":3,"sources":["/home/fabricio7p/Documents/Projects/Ikebana/front/src/components/pages/Account/components/New/NewProject.js"],"names":["React","useEffect","useState","useDispatch","useSelector","api","useForm","Modal","ErrorDialog","InfoDialog","NewProject","allow","setAllow","register","handleSubmit","errors","watch","authKey","state","auth","keys","userData","account","error","setError","info","setInfo","data","setData","loading","setLoading","file1","setFile1","file2","setFile2","file3","setFile3","handleInputChange","e","inputNum","target","name","split","file","files","size","toFixed","includes","type","preview","URL","createObjectURL","onSubmit","project_type","project_title","project_desc","project_allow","project_video","formData","FormData","append","method","url","headers","key","response","console","log","required","minLength","maxLength","marginTop","window","location","pathname"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport api from 'services/api'\nimport { useForm } from 'react-hook-form';\n\nimport Modal from '../../../../aux/Modal';\nimport ErrorDialog from '../../../../aux/ErrorDialog/ErrorDialog';\nimport InfoDialog from '../../../../aux/InfoDialog/InfoDialog';\n\n\nimport './styles.scss';\n\nexport default function NewProject() {\n    //toggle allow button only if arrangement is selected\n    const [allow, setAllow] = useState(false);\n\n    //forms\n    const { register, handleSubmit, errors, watch } = useForm();\n\n    //store select\n    const authKey = useSelector(state => state.auth.keys)\n    const userData = useSelector(state => state.account.userData[0])\n\n    //dialog\n    const [error, setError] = useState(false);\n    const [info, setInfo] = useState(false);\n\n    //feeding data\n    const [data, setData] = useState(false);\n    const [loading, setLoading] = useState(false);\n\n    //picture inputs\n    const [file1, setFile1] = useState([]);\n    const [file2, setFile2] = useState([]);\n    const [file3, setFile3] = useState([]);\n\n    const handleInputChange = (e) => {\n        const inputNum = e.target.name.split('file')[1]\n        const file = e.target.files[0]\n\n        if (!file) {\n            setError('Selecione alguma foto')\n            return void 0\n        }\n\n        if (((file.size/1024)/1024).toFixed() > 5) {\n            setError('Selecione um arquivo menor que 5MB')\n            return void 0\n        }\n\n        if (!(['image/png', 'image/jpeg'].includes(file.type))){\n            setError('Formato inválido, selecione apenas imagens JPG ou PNG')\n            return void 0\n        }\n\n        const preview = URL.createObjectURL(file)\n\n        switch(inputNum) {\n            case '1': {\n                setFile1({ file, preview})\n                break;\n            }\n            case '2': {\n                setFile2({ file, preview})\n                break;\n            }\n            case '3': {\n                setFile3({ file, preview})\n                break;\n            }\n            default: {\n                return void 0\n            }\n        }\n    }\n\n    const onSubmit = async ({ \n        project_type,\n        project_title,\n        project_desc,\n        project_allow,\n        project_video }) => {\n            setLoading(true)\n            const formData = new FormData();\n            try {\n                formData.append('project_type', project_type)\n                formData.append('project_title', project_title)\n                formData.append('project_desc', project_desc)\n                formData.append('project_video', project_video)\n                formData.append('project_allow', project_allow)\n                formData.append('file1', file1.file)\n                formData.append('file2', file2.file)\n                formData.append('file3', file3.file)\n                const response = await api({\n                    method: 'post',\n                    url: '/projects',\n                    headers: {\n                        'Authorization': `Bearer ${authKey[0].key}`,\n                        'Content-Type': 'multipart/form-data'\n                    },\n                    data: formData,\n                })\n                response.data && setInfo('Projeto criado com sucesso.')\n                console.log(response.data)\n            } catch(e) {\n                setError('Um projeto com este nome já existe')\n            } finally {\n                setLoading(false)\n            }\n        }\n\n    useEffect(() => {\n        setFile1({preview: ''})\n        setFile2({preview: ''})\n        setFile3({preview: ''})\n    },[])\n\n    return(\n        <>\n            <div className=\"new\">\n                <div className=\"new__header\">\n                    <p className=\"password__header--title\">Criar um novo projeto.</p>\n                </div>\n                <form onSubmit={handleSubmit(onSubmit)}>\n                    <div className=\"new__inputs\">\n                        <p className=\"new__inputs--desc\">Informações do projeto</p>\n                        <div className=\"new__inputs--container acc-field\">\n                            <label htmlFor=\"project-name\"\n                                className=\"input-label acc-field__title\">\n                                Tipo</label>\n                            {errors.project_type && <div title=\"Você deve escolher um tipo\" \n                            className=\"validation-overlay-new\">\n                            <i className=\"material-icons\">error_outline</i></div>}\n\n                            <div className=\"project-type\">\n                                <label className=\"project-type__label\" onClick={() => setAllow(true)}\n                                    htmlFor=\"arrangement\">Arranjo\n                                </label>\n                                <input className=\"project-type__input\" onClick={() => setAllow(true)} \n                                    value=\"arrangement\" type=\"radio\" id=\"arrangement\" name=\"project_type\"\n                                    ref={register({required: true})}/>\n                                <label className=\"project-type__label\" onClick={() => setAllow(false)}\n                                    htmlFor=\"lesson\">Aula\n                                </label>\n                                <input className=\"project-type__input\" onClick={() => setAllow(false)} \n                                    value=\"lesson\" type=\"radio\" id=\"lesson\" ref={register({required: true})} \n                                    name=\"project_type\" />\n                            </div>\n                        </div>\n                        <div className=\"new__inputs--container acc-field\">\n                            <label htmlFor=\"project-name\"\n                                className=\"input-label acc-field__title\">\n                                Nome do Projeto</label>\n                            <input type=\"text\" ref={register({required: true, \n                                minLength: 6, maxLength: 35})} \n                                className=\"account-input\" name=\"project_title\"\n                                id=\"project-name\"/>\n                                {errors.project_title && <div title=\"Mínimo de 6 caracteres e Máximo 35\" \n                                className=\"validation-overlay-new\">\n                                <i className=\"material-icons\">error_outline</i></div>}\n                        </div>\n                        <div className=\"new__inputs--container acc-field\">\n                            <label htmlFor=\"project-desc\"\n                                className=\"input-label acc-field__title\">\n                                Descrição</label>\n                            <textarea id=\"project-desc\" \n                                className=\"account-input\" ref={register({required: true, minLength: 20})}\n                                placeholder=\"Texto descritivo ou explicativo\" \n                                name=\"project_desc\">\n                            </textarea>\n                                {errors.project_desc && <div title=\"É preciso incluir uma descrição de no mínimo 20 caractéres\"\n                                className=\"validation-overlay-new\">\n                                <i className=\"material-icons\">error_outline</i></div>}\n                        </div>\n                        <div className=\"new__inputs--container acc-field\">\n                            <label style={{marginTop: \"2px\"}} htmlFor=\"project-name\"\n                                className=\"input-label acc-field__title\">\n                                Solicitações\n                            </label>\n                            <div className={`project-type ${!allow && 'hidden-allow'}`}>\n                                <label className=\"project-type__label\" \n                                    htmlFor=\"project_allow\">Permitir?\n                                </label>\n                                <input className=\"project-type__input\" \n                                    id=\"project_allow\" type=\"checkbox\" \n                                    name=\"project_allow\" ref={register()}/>\n                                <i title=\"Permitir que outras pessoas solicitem este arranjo.\" className=\"material-icons help-allow\">help</i>\n                            </div>\n                        </div>\n                        <div className=\"new__inputs--container acc-field\">\n                            <label className=\"input-label acc-field__title\">\n                                Fotos do Projeto</label>\n                            <div className=\"picture-wrapper\">\n                                <div className=\"picture-container\">\n                                    <button className=\"picture-container__btn\">\n                                        <button className=\n                                            {`close-overlay ${ !file1.preview \n                                            ? 'inactive' : '' }`}\n                                            onClick={() => setFile1([])}>\n                                        <i className=\"material-icons\">close</i></button>\n                                        <img src={file1.preview} \n                                            className=\"img-preview\" alt=\"\" />\n                                        <i className=\"material-icons\">add</i>\n                                        <input type=\"file\" ref={register()} \n                                            onChange={handleInputChange}\n                                            className=\"picture-input\" \n                                            name=\"file1\" />\n                                    </button>\n                                </div>\n                                <div className=\"picture-container\">\n                                    <button className=\"picture-container__btn\">\n                                        <button className=\n                                            {`close-overlay ${ !file2.preview \n                                            ? 'inactive' : '' }`}\n                                            onClick={() => setFile2([])}>\n                                        <i className=\"material-icons\">close</i></button>\n                                        <img src={file2.preview} \n                                            className=\"img-preview\" alt=\"\" />\n                                        <i className=\"material-icons\">add</i>\n                                        <input type=\"file\" ref={register()} \n                                            onChange={handleInputChange}\n                                            className=\"picture-input\" \n                                            name=\"file2\" />\n                                    </button>\n                                </div>\n                                <div className=\"picture-container\">\n                                    <button className=\"picture-container__btn\">\n                                        <button className=\n                                            {`close-overlay ${ !file3.preview \n                                            ? 'inactive' : '' }`}\n                                            onClick={() => setFile3([])}>\n                                        <i className=\"material-icons\">close</i></button>\n                                        <img src={file3.preview} \n                                            className=\"img-preview\" alt=\"\" />\n                                        <i className=\"material-icons\">add</i>\n                                        <input type=\"file\" ref={register()} \n                                            onChange={handleInputChange}\n                                            className=\"picture-input\" \n                                            name=\"file3\" />\n                                    </button>\n                                </div>\n                            </div>\n                        </div>\n                        <p className=\"new__inputs--desc\">Videoaula</p>\n                        <div className=\"new__inputs--container acc-field\">\n                            <label htmlFor=\"project-video\"\n                                className=\"input-label acc-field__title\">\n                                Link do Video</label>\n                            <input type=\"text\" className=\"account-input\" \n                                id=\"project-video\" ref={register()} name=\"project_video\"\n                                placeholder=\"Somente links do YouTube\"/>\n                        </div>\n                        <button className=\"app-btn btn-filled\">\n                            {\n                                loading === true ? <div className=\"sizer\">\n                                    <div class=\"lds-ellipsis\"><div></div>\n                                        <div></div><div></div><div></div></div>\n                                </div>\n                                :\n                                <p>Concluir</p>\n                            }\n                        </button>\n                    </div>\n                </form>\n            </div>\n            {\n                error &&\n                    <Modal>\n                        <ErrorDialog value={error} handler={() =>{\n                            setError(false)\n                        } }/>\n                    </Modal>\n            }\n            {\n                info &&\n                    <Modal>\n                        <InfoDialog value={info} handler={() => {\n                            setInfo(false)\n                            window.location.pathname = '/home'\n                        }}/>\n                    </Modal>\n            }\n        </>\n    );\n}\n"]},"metadata":{},"sourceType":"module"}