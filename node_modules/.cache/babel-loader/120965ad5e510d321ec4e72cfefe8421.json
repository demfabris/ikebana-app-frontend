{"ast":null,"code":"import _regeneratorRuntime from\"/home/fabricio7p/Documents/Projects/Ikebana/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/fabricio7p/Documents/Projects/Ikebana/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/fabricio7p/Documents/Projects/Ikebana/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{useDispatch,useSelector}from'react-redux';import{useHistory}from'react-router-dom';import api from'services/api';import{useForm}from'react-hook-form';import Modal from'../../../../aux/Modal';import ErrorDialog from'../../../../aux/ErrorDialog/ErrorDialog';import InfoDialog from'../../../../aux/InfoDialog/InfoDialog';import'./styles.scss';export default function Password(){var _useForm=useForm(),register=_useForm.register,handleSubmit=_useForm.handleSubmit,errors=_useForm.errors,watch=_useForm.watch;var authKey=useSelector(function(state){return state.auth.keys;});var userData=useSelector(function(state){return state.account.userData[0];});var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),error=_useState4[0],setError=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),info=_useState6[0],setInfo=_useState6[1];var _useState7=useState({}),_useState8=_slicedToArray(_useState7,2),data=_useState8[0],setData=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),member=_useState10[0],setMember=_useState10[1];var history=useHistory();var onSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref){var old_pass,new_pass,confirm_pass,response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:old_pass=_ref.old_pass,new_pass=_ref.new_pass,confirm_pass=_ref.confirm_pass;setLoading(true);_context.prev=2;_context.next=5;return api({method:'post',url:'/user',headers:{'Authorization':\"Bearer \".concat(authKey[0].key)},data:{old_pass:old_pass,new_pass:new_pass,confirm_pass:confirm_pass}});case 5:response=_context.sent;response.data.password&&setInfo('Senha alterada com sucesso.');_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](2);_context.t0.message.includes('401')&&setError(\"Senha atual incorreta\");case 12:_context.prev=12;setLoading(false);return _context.finish(12);case 15:case\"end\":return _context.stop();}}},_callee,null,[[2,9,12,15]]);}));return function onSubmit(_x){return _ref2.apply(this,arguments);};}();useEffect(function(){setData(userData);data.isPartner&&setMember(true);},[]);return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"password\"},/*#__PURE__*/React.createElement(\"div\",{className:\"password__header\"},/*#__PURE__*/React.createElement(\"p\",{className:\"password__header--title\"},\"Editar informa\\xE7\\xF5es pessoais.\")),/*#__PURE__*/React.createElement(\"form\",{onSubmit:handleSubmit(onSubmit)},/*#__PURE__*/React.createElement(\"div\",{className:\"password__inputs\"},/*#__PURE__*/React.createElement(\"p\",{className:\"password__inputs--desc\"},\"Editar senha\"),/*#__PURE__*/React.createElement(\"div\",{className:\"password__inputs--container acc-field\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"old_pass\",className:\"input-label acc-field__title\"},\"Senha Antiga\"),/*#__PURE__*/React.createElement(\"input\",{ref:register({required:true,minLength:6}),name:\"old_pass\",type:\"password\",className:\"account-input\",id:\"old_pass\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"password__inputs--container acc-field\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"new_pass\",className:\"password-label acc-field__title\"},\"Senha Nova\",errors.new_pass&&/*#__PURE__*/React.createElement(\"div\",{title:\"M\\xEDnimo de 6 caracteres\",className:\"validation-overlay-acc\"},/*#__PURE__*/React.createElement(\"i\",{className:\"material-icons\"},\"error_outline\"))),/*#__PURE__*/React.createElement(\"input\",{type:\"password\",ref:register({required:true,minLength:6}),name:\"new_pass\",className:\"account-input\",id:\"new_pass\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"password__inputs--container acc-field\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"confirm_pass\",className:\"input-label acc-field__title\"},\"Confirmar Senha\",errors.confirm_pass&&/*#__PURE__*/React.createElement(\"div\",{title:\"As senhas n\\xE3o coincidem\",className:\"validation-overlay-acc\"},/*#__PURE__*/React.createElement(\"i\",{className:\"material-icons\"},\"error_outline\"))),/*#__PURE__*/React.createElement(\"input\",{ref:register({required:true,minLength:6,validate:function validate(value){return value===watch('new_pass');}}),name:\"confirm_pass\",type:\"password\",className:\"account-input\",id:\"confirm_pass\"})),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"app-btn btn-filled\"},loading===true?/*#__PURE__*/React.createElement(\"div\",{className:\"sizer\"},/*#__PURE__*/React.createElement(\"div\",{class:\"lds-ellipsis\"},/*#__PURE__*/React.createElement(\"div\",null),/*#__PURE__*/React.createElement(\"div\",null),/*#__PURE__*/React.createElement(\"div\",null),/*#__PURE__*/React.createElement(\"div\",null))):/*#__PURE__*/React.createElement(\"p\",null,member===true?'Atualizar':'Concluir'))))),error&&/*#__PURE__*/React.createElement(Modal,null,/*#__PURE__*/React.createElement(ErrorDialog,{value:error,handler:function handler(){setError(false);}})),info&&/*#__PURE__*/React.createElement(Modal,null,/*#__PURE__*/React.createElement(InfoDialog,{value:info,handler:function handler(){setInfo(false);window.location.pathname='/home';}})));}","map":{"version":3,"sources":["/home/fabricio7p/Documents/Projects/Ikebana/front/src/components/pages/Account/components/Password/Password.js"],"names":["React","useState","useEffect","useDispatch","useSelector","useHistory","api","useForm","Modal","ErrorDialog","InfoDialog","Password","register","handleSubmit","errors","watch","authKey","state","auth","keys","userData","account","loading","setLoading","error","setError","info","setInfo","data","setData","member","setMember","history","onSubmit","old_pass","new_pass","confirm_pass","method","url","headers","key","response","password","message","includes","isPartner","required","minLength","validate","value","window","location","pathname"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useHistory } from 'react-router-dom';\nimport api from 'services/api'\nimport { useForm } from 'react-hook-form';\n\nimport Modal from '../../../../aux/Modal';\nimport ErrorDialog from '../../../../aux/ErrorDialog/ErrorDialog';\nimport InfoDialog from '../../../../aux/InfoDialog/InfoDialog';\n\nimport './styles.scss';\n\nexport default function Password() {\n    const { register, handleSubmit, errors, watch } = useForm();\n    const authKey = useSelector(state => state.auth.keys)\n    const userData = useSelector(state => state.account.userData[0])\n    const [loading, setLoading] = useState(false);\n    const [error, setError] = useState(false);\n    const [info, setInfo] = useState(false);\n    const [data, setData] = useState({})\n    const [member, setMember] = useState(false);\n    const history = useHistory();\n\n    const onSubmit = async ({ old_pass, new_pass, confirm_pass }) => {\n        setLoading(true)\n        try {\n            const response = await api({\n                method: 'post',\n                url: '/user',\n                headers: {\n                    'Authorization': `Bearer ${authKey[0].key}`,\n                },\n                data: {\n                    old_pass,\n                    new_pass,\n                    confirm_pass\n                }\n            })\n            response.data.password && setInfo('Senha alterada com sucesso.')\n        } catch(e) {\n            e.message.includes('401') && setError(\"Senha atual incorreta\")\n        } finally {\n            setLoading(false)\n        }\n    }\n\n    useEffect(() => {\n        setData(userData)\n        data.isPartner && setMember(true)\n    }, [])\n\n    return(\n        <>\n        <div className=\"password\">\n            <div className=\"password__header\">\n                <p className=\"password__header--title\">Editar informações pessoais.</p>\n            </div>\n            <form onSubmit={handleSubmit(onSubmit)}>\n                <div className=\"password__inputs\">\n                    <p className=\"password__inputs--desc\">Editar senha</p>\n                    <div className=\"password__inputs--container acc-field\">\n                        <label htmlFor=\"old_pass\"\n                            className=\"input-label acc-field__title\">\n                            Senha Antiga</label>\n                        <input ref={register({required: true, minLength: 6})} name=\"old_pass\" \n                            type=\"password\" className=\"account-input\" id=\"old_pass\"/>\n                    </div>\n                    <div className=\"password__inputs--container acc-field\">\n                        <label htmlFor=\"new_pass\" \n                            className=\"password-label acc-field__title\">\n                            Senha Nova\n                            {errors.new_pass && <div title=\"Mínimo de 6 caracteres\" \n                                className=\"validation-overlay-acc\">\n                                <i className=\"material-icons\">error_outline</i></div> }\n                        </label>\n                        <input type=\"password\" ref={register({required: true, minLength: 6})} \n                            name=\"new_pass\" className=\"account-input\" id=\"new_pass\"/>\n                    </div>\n                    <div className=\"password__inputs--container acc-field\">\n                        <label htmlFor=\"confirm_pass\" \n                            className=\"input-label acc-field__title\">\n                            Confirmar Senha\n                            {errors.confirm_pass && <div title=\"As senhas não coincidem\" \n                            className=\"validation-overlay-acc\">\n                            <i className=\"material-icons\">error_outline</i></div> }\n                        </label>\n                        <input ref={register({required: true, minLength: 6,\n                            validate: value => value === watch('new_pass') }) } \n                            name=\"confirm_pass\" type=\"password\" className=\"account-input\" \n                            id=\"confirm_pass\"/>\n                    </div>\n                    <button type=\"submit\" className=\"app-btn btn-filled\">\n                        {\n                            loading === true ? <div className=\"sizer\">\n                                <div class=\"lds-ellipsis\"><div></div>\n                                    <div></div><div></div><div></div></div>\n                            </div>\n                            :\n                            <p>{ member === true ? 'Atualizar' : 'Concluir' }</p>\n                        }\n                    </button>\n                </div>\n            </form>\n        </div>\n            {\n                error &&\n                    <Modal>\n                        <ErrorDialog value={error} handler={() =>{\n                            setError(false)\n                        } }/>\n                    </Modal>\n            }\n            {\n                info &&\n                    <Modal>\n                        <InfoDialog value={info} handler={() => {\n                            setInfo(false)\n                            window.location.pathname = '/home'\n                        }}/>\n                    </Modal>\n            }\n        </>\n    );\n}\n"]},"metadata":{},"sourceType":"module"}