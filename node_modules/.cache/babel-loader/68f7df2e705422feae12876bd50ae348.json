{"ast":null,"code":"import _regeneratorRuntime from\"/home/fabricio7p/Documents/Projects/Ikebana/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/fabricio7p/Documents/Projects/Ikebana/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/fabricio7p/Documents/Projects/Ikebana/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{Link}from'react-router-dom';import api from'services/api';import{useSelector}from'react-redux';import'./styles.scss';export default function LessonCard(el){var authKey=useSelector(function(state){return state.auth.keys;});var _useState=useState(true),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),userID=_useState4[0],setUserID=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),liked=_useState6[0],setLiked=_useState6[1];var fetchUsername=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var key,username,_args=arguments;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:key=_args.length>0&&_args[0]!==undefined?_args[0]:authKey;_context.prev=1;_context.next=4;return api({method:'get',url:'/user',headers:{'Authorization':\"Bearer \".concat(key[0].key)}});case 4:username=_context.sent;setUserID(username.data.id);_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](1);console.log(_context.t0);case 11:_context.prev=11;setLoading(false);return _context.finish(11);case 14:case\"end\":return _context.stop();}}},_callee,null,[[1,8,11,14]]);}));return function fetchUsername(){return _ref.apply(this,arguments);};}();var commitLike=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var key,response,_args2=arguments;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:key=_args2.length>0&&_args2[0]!==undefined?_args2[0]:authKey;_context2.prev=1;_context2.next=4;return api({method:'post',url:'/like_project',headers:{'Authorization':\"Bearer \".concat(key[0].key)},data:{project_id:el.project_id}});case 4:response=_context2.sent;console.log(response.data);_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](1);console.log(_context2.t0);case 11:case\"end\":return _context2.stop();}}},_callee2,null,[[1,8]]);}));return function commitLike(){return _ref2.apply(this,arguments);};}();useEffect(function(){authKey.length!==0&&fetchUsername();},[]);return/*#__PURE__*/React.createElement(\"div\",{className:\"lesson\"},/*#__PURE__*/React.createElement(\"div\",{className:\"lesson-main\"},/*#__PURE__*/React.createElement(\"div\",{className:\"lesson-main__picture\"},/*#__PURE__*/React.createElement(\"img\",{className:\"lesson-pic\",src:el.pictures.file1})),/*#__PURE__*/React.createElement(\"div\",{className:\"lesson-main__title\"},/*#__PURE__*/React.createElement(\"h2\",{className:\"lesson-title\"},el.name),/*#__PURE__*/React.createElement(\"p\",{className:\"lesson-desc\"},el.description),/*#__PURE__*/React.createElement(\"a\",{className:\"lesson-autor\"},el.autor_fullname)),/*#__PURE__*/React.createElement(\"div\",{className:\"lesson-main__buttons\"},/*#__PURE__*/React.createElement(\"button\",{title:\"Em breve\",className:\"lesson-main__buttons--hidden share-btn\"},/*#__PURE__*/React.createElement(\"i\",{className:\"material-icons\"},\"share\")),/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){setLiked(true);commitLike();},className:\"lesson-main__buttons--hidden like-btn \\n                            \".concat(authKey.length===0?'like-disabled':'')},Object.keys(el.liked_by).includes(userID.toString())?/*#__PURE__*/React.createElement(\"i\",{title:\"Curtido\",className:\"material-icons\"},\"favorite\"):/*#__PURE__*/React.createElement(\"i\",{className:\"material-icons\"},liked?'favorite':'favorite_border')),/*#__PURE__*/React.createElement(\"div\",{className:\"lesson-main__buttons--wrapper\"},/*#__PURE__*/React.createElement(Link,{className:\"btn-link\",to:{pathname:\"/lesson/\".concat(el.project_id)}},/*#__PURE__*/React.createElement(\"button\",{className:\"app-btn\"},\"Acessar\"))))));}","map":{"version":3,"sources":["/home/fabricio7p/Documents/Projects/Ikebana/front/src/components/cards/LessonCard/LessonCard.js"],"names":["React","useState","useEffect","Link","api","useSelector","LessonCard","el","authKey","state","auth","keys","loading","setLoading","userID","setUserID","liked","setLiked","fetchUsername","key","method","url","headers","username","data","id","console","log","commitLike","project_id","response","length","pictures","file1","name","description","autor_fullname","Object","liked_by","includes","toString","pathname"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport api from 'services/api';\nimport { useSelector } from 'react-redux';\n\nimport './styles.scss';\n\n\nexport default function LessonCard(el) {\n    const authKey = useSelector(state => state.auth.keys);\n    const [loading, setLoading] = useState(true);\n    const [userID, setUserID] = useState(false);\n    const [liked, setLiked] = useState(false);\n\n\n    const fetchUsername = async (key=authKey) => {\n        try {\n            const username = await api({\n                method: 'get',\n                url: '/user',\n                headers: {\n                    'Authorization': `Bearer ${key[0].key}`\n                },\n            })\n            setUserID(username.data.id)\n        } catch(e) {\n            console.log(e)\n        } finally {\n            setLoading(false)\n        }\n    }\n\n    const commitLike = async (key=authKey) => {\n        try {\n            const response = await api({\n                method: 'post',\n                url: '/like_project',\n                headers: {\n                    'Authorization': `Bearer ${key[0].key}`\n                },\n                data: {\n                    project_id: el.project_id\n                }\n            })\n            console.log(response.data)\n        } catch(e) {\n            console.log(e)\n        } \n    }\n\n    useEffect(() => {\n        authKey.length !== 0 && fetchUsername()\n    },[])\n\n    return(\n        <div className=\"lesson\">\n            <div className=\"lesson-main\">\n                <div className=\"lesson-main__picture\">\n                    <img className=\"lesson-pic\" src={el.pictures.file1} />\n                </div>\n                <div className=\"lesson-main__title\">\n                    <h2 className=\"lesson-title\">{el.name}</h2>\n                    <p className=\"lesson-desc\">{el.description}</p>\n                    <a className=\"lesson-autor\">{el.autor_fullname}</a>\n                </div>\n                <div className=\"lesson-main__buttons\">\n                    <button title=\"Em breve\" className=\"lesson-main__buttons--hidden share-btn\">\n                        <i className=\"material-icons\">share</i>\n                    </button>\n                    <button onClick={() => {\n                        setLiked(true)\n                        commitLike()\n                    }} \n                        className={`lesson-main__buttons--hidden like-btn \n                            ${authKey.length === 0 ? 'like-disabled' : ''}`}>\n                        {\n                            Object.keys(el.liked_by).includes(userID.toString()) ?\n                                <i title=\"Curtido\" className=\"material-icons\">favorite</i>\n                                :\n                                <i className=\"material-icons\">{liked ? 'favorite' : 'favorite_border'}</i>\n                        }\n                    </button>\n                    <div className=\"lesson-main__buttons--wrapper\">\n                        <Link className=\"btn-link\" to={{\n                            pathname: `/lesson/${el.project_id}`\n                        }}>\n                            <button className=\"app-btn\">\n                                Acessar\n                            </button>\n                        </Link>\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n}\n"]},"metadata":{},"sourceType":"module"}